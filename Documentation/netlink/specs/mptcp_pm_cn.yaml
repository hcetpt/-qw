# SPDX 许可证标识符: ((GPL-2.0 WITH Linux-syscall-note) 或 BSD-3-Clause)

名称: mptcp_pm
协议: genetlink-legacy
文档: 多路径 TCP
C 语言家族名称: mptcp-pm-name
C 语言版本名称: mptcp-pm-ver
通过定义最大值: true
内核策略: 每个操作
命令计数名称: --mptcp-pm-cmd-after-last

定义:
  -
    类型: 枚举
    名称: event-type
    枚举名称: mptcp-event-type
    名称前缀: mptcp-event-
    条目:
     -
      名称: unspec
      文档: 未使用的事件
     -
      名称: created
      文档:
        标记, 家族, saddr4 | saddr6, daddr4 | daddr6, sport, dport
        新的 MPTCP 连接已被创建。这是分配内存和根据需要发送 ADD_ADDR 的好时机。根据流量模式，可能需要很长时间才能发送 MPTCP_EVENT_ESTABLISHED。
-
      名称: established
      文档:
        标记, 家族, saddr4 | saddr6, daddr4 | daddr6, sport, dport
        MPTCP 连接已建立（可以开始新的子流）
-
      名称: closed
      文档:
        标记
        MPTCP 连接已停止
-
      名称: announced
      值: 6
      文档:
        标记, rem_id, 家族, daddr4 | daddr6 [, dport]
        对等方已宣布新地址
-
      名称: removed
      文档:
        标记, rem_id
        对等方已丢失地址
-
      名称: sub-established
      值: 10
      文档:
        标记, 家族, loc_id, rem_id, saddr4 | saddr6, daddr4 | daddr6, sport,
        dport, backup, if_idx [, 错误]
        已建立新的子流。'错误' 不应设置
-
      名称: sub-closed
      文档:
        标记, 家族, loc_id, rem_id, saddr4 | saddr6, daddr4 | daddr6, sport,
        dport, backup, if_idx [, 错误]
        子流已关闭。如果检测到此子流的错误，则可以设置错误（sk_err 的副本）
-
      名称: sub-priority
      值: 13
      文档:
        标记, 家族, loc_id, rem_id, saddr4 | saddr6, daddr4 | daddr6, sport,
        dport, backup, if_idx [, 错误]
        子流的优先级已更改。'错误' 不应设置
-
      名称: listener-created
      值: 15
      文档:
        家族, sport, saddr4 | saddr6
        创建了新的 PM 监听器
下面是给定内容的中文翻译：

---
### 定义：
- **名称**: listener-closed
- **文档**:
  - `family`, `sport`, `saddr4` | `saddr6`
  - 表示一个多路径TCP监听器被关闭

### 属性集：
#### 1. 地址属性集 (`address`)
- **前缀**: `mptcp-pm-addr-attr-`
- **属性**:
  - **未指定 (`unspec`)**
    - 类型: 未使用 (`unused`)
    - 值: 0
  - **家族 (`family`)**
    - 类型: `u16`
  - **标识 (`id`)**
    - 类型: `u8`
  - **IPv4地址 (`addr4`)**
    - 类型: `u32`
    - 字节顺序: 大端
  - **IPv6地址 (`addr6`)**
    - 类型: 二进制 (`binary`)
    - 检查:
      - 精确长度: 16
  - **端口 (`port`)**
    - 类型: `u16`
    - 字节顺序: 大端
  - **标志 (`flags`)**
    - 类型: `u32`
  - **接口索引 (`if-idx`)**
    - 类型: `s32`

#### 2. 子流属性集 (`subflow-attribute`)
- **前缀**: `mptcp-subflow-attr-`
- **属性**:
  - **未指定 (`unspec`)**
    - 类型: 未使用 (`unused`)
    - 值: 0
  - **远程令牌 (`token-rem`)**
    - 类型: `u32`
  - **本地令牌 (`token-loc`)**
    - 类型: `u32`
  - **相对写序列号 (`relwrite-seq`)**
    - 类型: `u32`
  - **映射序列号 (`map-seq`)**
    - 类型: `u64`
  - **映射子流序列号 (`map-sfseq`)**
    - 类型: `u32`
  - **SSN偏移 (`ssn-offset`)**
    - 类型: `u32`
  - **映射数据长度 (`map-datalen`)**
    - 类型: `u16`
  - **标志 (`flags`)**
    - 类型: `u32`
  - **远程标识 (`id-rem`)**
    - 类型: `u8`
  - **本地标识 (`id-loc`)**
    - 类型: `u8`
  - **填充 (`pad`)**
    - 类型: 填充 (`pad`)

#### 3. 终端点 (`endpoint`)
- **前缀**: `mptcp-pm-endpoint-`
- **属性**:
  - **地址 (`addr`)**
    - 类型: 嵌套 (`nest`)
    - 嵌套属性: 地址 (`address`)

#### 4. 属性 (`attr`)
- **前缀**: `mptcp-pm-attr-`
- **属性计数名称**: `--mptcp-attr-after-last`
- **属性**:
  - **未指定 (`unspec`)**
    - 类型: 未使用 (`unused`)
    - 值: 0
  - **地址 (`addr`)**
    - 类型: 嵌套 (`nest`)
    - 嵌套属性: 地址 (`address`)
  - **接收地址数量 (`rcv-add-addrs`)**
    - 类型: `u32`
  - **子流数量 (`subflows`)**
    - 类型: `u32`
  - **令牌 (`token`)**
    - 类型: `u32`
  - **本地标识 (`loc-id`)**
    - 类型: `u8`
  - **远程地址 (`addr-remote`)**
    - 类型: 嵌套 (`nest`)
    - 嵌套属性: 地址 (`address`)

#### 5. 事件属性 (`event-attr`)
- **枚举名称**: `mptcp-event-attr`
- **前缀**: `mptcp-attr-`
- **属性**:
  - **未指定 (`unspec`)**
    - 类型: 未使用 (`unused`)
    - 值: 0
  - **令牌 (`token`)**
    - 类型: `u32`
  - **家族 (`family`)**
    - 类型: `u16`
  - **本地标识 (`loc-id`)**
    - 类型: `u8`
  - **远程标识 (`rem-id`)**
    - 类型: `u8`
  - **源IPv4地址 (`saddr4`)**
    - 类型: `u32`
    - 字节顺序: 大端
  - **源IPv6地址 (`saddr6`)**
    - 类型: 二进制 (`binary`)
    - 检查:
      - 最小长度: 16
  - **目标IPv4地址 (`daddr4`)**
    - 类型: `u32`
    - 字节顺序: 大端
  - **目标IPv6地址 (`daddr6`)**
    - 类型: 二进制 (`binary`)
    - 检查:
      - 最小长度: 16
  - **源端口 (`sport`)**
    - 类型: `u16`
    - 字节顺序: 大端
  - **目标端口 (`dport`)**
    - 类型: `u16`
    - 字节顺序: 大端
  - **备份 (`backup`)**
    - 类型: `u8`
  - **错误 (`error`)**
    - 类型: `u8`
  - **标志 (`flags`)**
    - 类型: `u16`
  - **超时 (`timeout`)**
    - 类型: `u32`
  - **接口索引 (`if_idx`)**
    - 类型: `u32`
  - **重置原因 (`reset-reason`)**
    - 类型: `u32`
  - **重置标志 (`reset-flags`)**
    - 类型: `u32`
  - **服务器端 (`server-side`)**
    - 类型: `u8`

### 操作：
#### 列表操作
1. **未指定 (`unspec`)**
   - 文档: 未使用
   - 值: 0
2. **添加终端点 (`add-addr`)**
   - 文档: 添加终端点
   - 属性集: 终端点 (`endpoint`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行:
     - 请求:
       - 属性:
         - 地址 (`addr`)
3. **删除终端点 (`del-addr`)**
   - 文档: 删除终端点
   - 属性集: 终端点 (`endpoint`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行: 同上
4. **获取终端点信息 (`get-addr`)**
   - 文档: 获取终端点信息
   - 属性集: 属性 (`attr`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行:
     - 请求:
       - 属性:
         - 地址 (`addr`)
         - 令牌 (`token`)
     - 回复:
       - 属性:
         - 地址 (`addr`)
   - 导出:
     - 回复:
       - 属性:
         - 地址 (`addr`)
5. **清除终端点 (`flush-addrs`)**
   - 文档: 清除终端点
   - 属性集: 终端点 (`endpoint`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行: 同上
6. **设置限制 (`set-limits`)**
   - 文档: 设置协议限制
   - 属性集: 属性 (`attr`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行:
     - 请求:
       - 属性:
         - 接收地址数量 (`rcv-add-addrs`)
         - 子流数量 (`subflows`)
7. **获取限制 (`get-limits`)**
   - 文档: 获取协议限制
   - 属性集: 属性 (`attr`)
   - 不验证: [严格]
   - 执行:
     - 请求:
       - 属性:
         - 接收地址数量 (`rcv-add-addrs`)
         - 子流数量 (`subflows`)
     - 回复:
       - 属性:
         - 接收地址数量 (`rcv-add-addrs`)
         - 子流数量 (`subflows`)
8. **设置标志 (`set-flags`)**
   - 文档: 更改终端点标志
   - 属性集: 属性 (`attr`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行:
     - 请求:
       - 属性:
         - 地址 (`addr`)
         - 令牌 (`token`)
         - 远程地址 (`addr-remote`)
9. **宣布 (`announce`)**
   - 文档: 宣布新子流
   - 属性集: 属性 (`attr`)
   - 不验证: [严格]
   - 标志: [未指定管理权限]
   - 执行:
     - 请求:
       - 属性:
         - 地址 (`addr`)
         - 令牌 (`token`)
10. **移除 (`remove`)**
    - 文档: 宣布移除
    - 属性集: 属性 (`attr`)
    - 不验证: [严格]
    - 标志: [未指定管理权限]
    - 执行:
      - 请求:
        - 属性:
          - 令牌 (`token`)
          - 本地标识 (`loc-id`)
11. **创建子流 (`subflow-create`)**
    - 文档: 待完成
    - 属性集: 属性 (`attr`)
    - 不验证: [严格]
    - 标志: [未指定管理权限]
    - 执行:
      - 请求:
        - 属性:
          - 地址 (`addr`)
          - 令牌 (`token`)
          - 远程地址 (`addr-remote`)
12. **销毁子流 (`subflow-destroy`)**
    - 文档: 待完成
    - 属性集: 属性 (`attr`)
    - 不验证: [严格]
    - 标志: [未指定管理权限]
    - 执行: 同上
