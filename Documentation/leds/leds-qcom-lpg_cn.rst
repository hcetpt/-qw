SPDX 许可证标识符：GPL-2.0

================================
高通 LPG 的内核驱动程序
================================

描述
--------------

高通 LPG 可在多种高通电源管理 IC（PMIC）中找到，它由多个脉冲宽度调制（PWM）通道、可编程模式查找表和 RGB LED 电流阱组成。
为了满足各种使用场景，LPG 通道可以作为独立的 LED、组合为 RGB LED 或以 PWM 通道的形式访问。每个 PWM 通道的输出被路由到其他硬件模块，如 RGB 电流阱、GPIO 引脚等。
每个 PWM 通道的工作周期可在 27 微秒至 384 秒之间，并且占空比具有 9 位分辨率。
为了在更深的空闲状态下支持与 CPU 子系统之间的状态通知，LPG 提供了模式支持。这包括一个共享的亮度值查找表以及每个通道的属性，用于选择表中的使用范围、速率以及模式是否应重复。
可以通过“pattern”触发器和 hw_pattern 属性来为通道编程模式。
/sys/class/leds/<led>/hw_pattern
--------------------------------

为高通 LPG LED 指定硬件模式
模式是一系列亮度和保持时间对，其中保持时间以毫秒表示。保持时间是模式的属性，因此对于模式中的每个元素必须相同（除了下面描述的暂停）。由于 LPG 硬件无法执行 leds-trigger-pattern 格式所期望的线性过渡，因此模式中的每个条目后都必须跟随一个零长度、相同亮度的条目。
简单模式示例：

    "255 500 255 0 0 500 0 0"

         ^
         |
    255 +----+    +----+
         |    |    |    |      ..
0 |    +----+    +----
         +------------------->
         0    5   10   15     时间 (100ms)

LPG 支持为模式中的第一个和最后一个元素指定更长的保持时间，即所谓的“低暂停”和“高暂停”。
低暂停模式示例：

    "255 1000 255 0 0 500 0 0 255 500 255 0 0 500 0 0"

         ^
         |
    255 +--------+    +----+    +----+    +--------+
         |        |    |    |    |    |    |        |      ..
同样地，可以通过在最后一个条目上使用更长的保持时间来延长其持续时长。
为了在共享查找表中节省空间，LPG支持“乒乓”模式，在这种模式下，每次执行模式都是先向前运行，然后向后运行。当给定的模式是回文时，驱动程序会自动使用此模式。在这种情况下，“高暂停”表示在反向运行模式前的等待时间，因此允许模式中间项的指定保持时间具有不同的保持时间。

具体翻译如下：

同样地，可以通过在最后一个条目上设置更高的保持时间来拉伸最后一个条目的时长。
为了在共享的查找表中节省空间，LPG（Linear Parameter Generator）支持"乒乓"模式，在这种模式下，每次通过模式都是首先正向运行该模式，然后反向运行。当给定的模式是一个回文串时，这个模式会被驱动器自动采用。在这种情况下，“高位暂停”表示的是在反向运行模式之前的等待时间，因此，模式中中间项所指定的保持时间被允许有一个不同的保持时间。

注：回文模式是指一个模式从前往后读和从后往前读是一样的。"高位暂停"和"保持时间"可能指的是在LPG中控制信号输出持续时间的参数。
