SPDX 许可声明标识符: GPL-2.0

==============================
高通 LPG 的内核驱动程序
==============================

描述
-----------

高通 LPG 可以在多种高通电源管理 IC (PMIC) 中找到，它包含多个脉冲宽度调制 (PWM) 通道、一个可编程模式查找表和一个 RGB LED 电流汇。为了适应各种应用场景，LPG 通道可以作为单独的 LED、组合为 RGB LED 或者以 PWM 通道的形式被访问。每个 PWM 通道的输出会被路由到其他硬件模块，例如 RGB 电流汇、GPIO 引脚等。
每个 PWM 通道可以设置 27 微秒到 384 秒之间的周期，并具有 9 位分辨率的占空比。
为了支持在更深层次的闲置状态中与 CPU 子系统进行状态通知，LPG 提供了模式支持。这包括一个共享的亮度值查找表和每个通道的属性来选择表中的使用范围、速率以及是否循环该模式。
一个通道的模式可以通过“pattern”触发器使用 hw_pattern 属性进行编程。
/sys/class/leds/<led>/hw_pattern
--------------------------------

为高通 LPG LED 指定硬件模式
模式是一系列亮度值和保持时间的配对，其中保持时间以毫秒为单位。保持时间是模式的一个属性，因此对于模式中的每个元素都必须相同（除了下面描述的暂停）。由于 LPG 硬件无法执行由 leds-trigger-pattern 格式期望的线性过渡，因此模式中的每个条目之后必须跟随一个相同亮度但长度为零的条目。
简单模式示例：

    "255 500 255 0 0 500 0 0"

        ^
        |
    255 +----+    +----+
        |    |    |    |      ..
0 |    +----+    +----
        +---------------------->
        0    5   10   15     时间 (100ms)

LPG 支持为模式的第一个和最后一个元素指定更长的保持时间，即所谓的“低暂停”和“高暂停”。
低暂停模式示例：

    "255 1000 255 0 0 500 0 0 255 500 255 0 0 500 0 0"

        ^
        |
    255 +--------+    +----+    +----+    +--------+
        |        |    |    |    |    |    |        |      ..
同样地，可以通过在最后一个条目上使用更长的保持时间来延长其持续时间。
为了节省共享查找表中的空间，LPG支持“乒乓”模式，在这种模式下，每次循环播放模式时都是先正向播放，然后反向播放。当给定的模式是回文时，驱动程序会自动使用此模式。在这种情况下，“高暂停”表示在反向播放模式之前的等待时间，因此允许模式中间项指定的保持时间与其它项有不同的保持时间。

- 上方的时间线示意如下（单位为100毫秒）:
  0 |        +----+    +----+    +----+        +----
   +----------------------------->
   0    5   10   15  20   25   时间 (100ms)
