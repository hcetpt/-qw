... SPDX 许可证标识符: GPL-2.0

========================
空块设备驱动程序
========================

概述
========

空块设备（`/dev/nullb*`）用于基准测试各种块层实现。它模拟了一个大小为X千兆字节的块设备。它不执行任何读/写操作，只是在请求队列中标记它们已完成。以下是一些可能的实例：

  多队列块层

    - 基于请求
- 每个设备可配置提交队列
无块层（称为基于bio）

    - 基于bio。I/O请求直接提交给设备驱动程序
- 直接接受bio数据结构并返回
所有这些都有一个针对系统中每个核心的完成队列
模块参数
=================

queue_mode=[0-2]：默认：2-多队列
  选择模块应实例化的块层
=  ============
  0  基于bio
  1  单队列（已弃用）
  2  多队列
  =  ============

home_node=[0--nr_nodes]：默认：NUMA_NO_NODE
  选择从哪个CPU节点分配数据结构
gb=[以GB为单位的大小]：默认：250GB
  报告给系统的设备大小
bs=[块大小（以字节为单位）]：默认：512字节
  报告给系统的块大小
nr_devices=[设备数量]: 默认: 1  
设备的数量。这些设备将被实例化为 /dev/nullb0 等。

irqmode=[0-2]: 默认: 1-软中断  
用于完成块层 I/O 的完成模式。
=  ===========================================================================
0  无  
1  软中断。使用 IPI 在不同的 CPU 节点间完成 I/O。模拟当 I/O 请求从设备所连接的主节点以外的其他 CPU 节点发出时所产生的开销。
2  定时器：每个 I/O 在完成前等待特定的时间（completion_nsec）
=  ===========================================================================

completion_nsec=[纳秒]: 默认: 10,000纳秒  
与 irqmode=2（定时器）一起使用。每个完成事件必须等待的时间。

submit_queues=[1..nr_cpus]: 默认: 1  
连接到设备驱动程序的提交队列的数量。如果不设置，默认为 1。对于多队列，当使用模块参数 use_per_node_hctx 设置为 1 时会被忽略。

hw_queue_depth=[0..队列深度]: 默认: 64  
设备的硬件队列深度。

memory_backed=[0/1]: 默认: 0  
是否使用内存缓冲区来响应 I/O 请求
=  =============================================
0  对 I/O 请求不传输数据
1  使用内存缓冲区来响应 I/O 请求
=  =============================================

discard=[0/1]: 默认: 0  
支持丢弃操作（需要内存支持的 null_blk 设备）
=  =====================================
0  不支持丢弃操作
1  启用对丢弃操作的支持
=  =====================================

cache_size=[MB 大小]: 默认: 0  
内存支持设备的缓存大小（以 MB 为单位）。
翻译如下：

Mbps = [最大带宽，单位：MB/s]：默认值：0（无限制）
设备性能的带宽限制
多队列特定参数
-------------------------------

use_per_node_hctx = [0/1]：默认值：0
硬件上下文队列的数量
=  =====================================================================
  0  提交队列的数量设置为提交队列（submit_queues）参数的值
  1  每个系统中的CPU节点都会实例化一个多队列块层，并配备一个硬件调度队列
=  =====================================================================

no_sched = [0/1]：默认值：0
启用/禁用 I/O 调度器
=  ======================================
  0  nullb* 使用默认的 blk-mq I/O 调度器
  1  nullb* 不使用 I/O 调度器
  =  ======================================

blocking = [0/1]：默认值：0
请求队列的阻塞行为
=  ===============================================================
  0  注册为非阻塞 blk-mq 驱动设备
  1  注册为阻塞 blk-mq 驱动设备，null_blk 将设置 BLK_MQ_F_BLOCKING 标志，表示它有时/总是需要在其 ->queue_rq() 函数中进行阻塞
=  ===============================================================

shared_tags = [0/1]：默认值：0
设备间共享标签
=  ================================================================
  0  标签集不共享
为blk-mq共享在各设备间的标签集。仅当`nr_devices > 1`时才有意义，否则没有可共享的标签集。
=  ===============================================================================================

zoned=[0/1]: 默认值：0
  设备是随机访问设备还是区域化块设备
=  ===============================================================================================
  0  块设备作为随机访问块设备暴露
1  块设备作为主机管理的区域化块设备暴露。需要`CONFIG_BLK_DEV_ZONED`
=  ===============================================================================================

zone_size=[MB]: 默认值：256
  当作为区域化块设备暴露时每个区域的大小。必须是2的幂次
zone_nr_conv=[nr_conv]: 默认值：0
  当块设备为区域化时创建的传统区域的数量。如果`zone_nr_conv >= nr_zones`，它将被减少到`nr_zones - 1`
