======================================
Moxa Smartio/Industio 家族设备驱动安装指南
======================================

版权所有 (C) 2008, Moxa Inc  
版权所有 (C) 2021, Jiri Slaby

.. 目录

   1. 引言
   2. 系统需求
   3. 安装
      3.1 硬件安装
      3.2 设备命名规则
   4. 实用工具
   5. Setserial
   6. 故障排除

1. 引言
^^^^^^^^^^^^^^^

   Smartio/Industio/UPCI 家族的 Linux 驱动支持以下多端口板卡：

    - 2端口多端口板卡
       CP-102U, CP-102UL, CP-102UF
       CP-132U-I, CP-132UL,
       CP-132, CP-132I, CP132S, CP-132IS,
       (CP-102, CP-102S)

    - 4端口多端口板卡
       CP-104EL,
       CP-104UL, CP-104JU,
       CP-134U, CP-134U-I,
       C104H/PCI, C104HS/PCI,
       CP-114, CP-114I, CP-114S, CP-114IS, CP-114UL,
       (C114HI, CT-114I),
       POS-104UL,
       CB-114,
       CB-134I

    - 8端口多端口板卡
       CP-118EL, CP-168EL,
       CP-118U, CP-168U,
       C168H/PCI,
       CB-108

   如果出现兼容性问题，请联系 Moxa，邮箱为 support@moxa.com.tw
除了设备驱动程序外，本版本还提供了有用的实用工具。它们是：

    - msdiag
         用于显示已安装的 Moxa Smartio/Industio 板卡的诊断程序
    - msmon
         用于观察数据计数和线路状态信号的监控程序
    - msterm
         一个简单的终端程序，在测试串行端口时非常有用

所有驱动程序和实用工具都以源代码形式发布，并遵循 GNU 通用公共许可证。请参阅每个源代码文件中的 GNU 通用公共许可证公告以获取更多详细信息。
在 Moxa 的网站上，您可以始终找到最新的驱动程序：
   https://www.moxa.com/

此版本的驱动程序可以作为可加载模块（模块驱动程序）进行安装，也可以内置到内核中（静态驱动程序）。在安装驱动程序之前，请参考用户手册中的硬件安装步骤。
我们假设用户应该熟悉以下文档：

   - Serial-HOWTO
   - Kernel-HOWTO

2. 系统需求
^^^^^^^^^^^^^^^^^^^^^

   - 最多可以组合安装4块板卡

3. 安装
^^^^^^^^^^^^^^^

3.1 硬件安装
=========================

PCI/UPCI 板卡
--------------

   您可能需要在 BIOS 中调整中断请求（IRQ）使用情况，以避免与其他 ISA 设备发生 IRQ 冲突。请提前参考用户手册中的硬件安装步骤。
PCI IRQ 共享
---------------

   同一块多端口板卡内的每个端口共享同一个 IRQ。最多可以在一个系统上同时安装 4 块 Moxa Smartio/Industio PCI 家族多端口板卡，并且它们可以共享同一个 IRQ。
3.2 设备命名规范
============================

   设备节点命名为 "ttyMxx"
当安装了多于两块板卡时的设备命名
-----------------------------------------------

   每个 Smartio/Industio 多端口板卡的命名规范预定义如下：
============ ===============
   板卡序号	设备节点
   第一块	ttyM0  - ttyM7
   第二块	ttyM8  - ttyM15
   第三块	ttyM16 - ttyM23
   第四块	ttyM24 - ttyM31
   ============ ===============

4. 工具程序
^^^^^^^^^^^^

   本驱动程序包含三个工具程序：msdiag、msmon 和 msterm。这三个工具程序以源代码形式发布。它们应当被编译为可执行文件并复制到 `/usr/bin` 目录中。
msdiag - 诊断工具
===================

   此工具程序提供显示驱动程序在系统中找到的 Moxa Smartio/Industio 板卡的功能
msmon - 端口监控
=======================

   此工具程序让用户能够快速查看所有 MOXA 端口的活动情况。用户可以轻松了解每个端口自启动监控以来的总接收/发送（Rx/Tx）字符计数
每秒的 Rx/Tx 吞吐量也会按固定间隔（例如最近的5秒）和平均值（自启动监控以来）报告。通过按下 `<HOME>` 键可以重置所有端口的计数。使用 `<+>` 和 `<>`（加号/减号）键来改变显示的时间间隔。在想要查看的端口上按下 `<ENTER>` 键，可以查看该端口的通信参数、信号状态以及输入/输出队列
msterm - 终端仿真
===========================

   此工具程序提供了所有 tty 端口的数据发送与接收能力，特别是针对 MOXA 端口。对于测试简单的应用非常有用，例如，向连接至端口的调制解调器发送 AT 命令或用作登录目的的终端。请注意，这仅仅是一个简单的终端仿真，并不支持全屏操作。
5. Setserial
^^^^^^^^^^^^

   支持的 Setserial 参数如下：
============== =============================================================
   uart		  设置 UART 类型（16450 --> 禁用FIFO，16550A --> 启用FIFO）
   close_delay	  设置关闭时 DTR 应保持低电平的时间（单位为百分之一秒）
closing_wait   设置串口在关闭时等待数据排空的时间（以1/100秒为单位），在此之后接收器将被禁用。

spd_hi         当应用程序请求38.4kb时使用57.6kb。
spd_vhi        当应用程序请求38.4kb时使用115.2kb。
spd_shi        当应用程序请求38.4kb时使用230.4kb。
spd_warp       当应用程序请求38.4kb时使用460.8kb。
spd_normal     当应用程序请求38.4kb时使用38.4kb。
spd_cust       当应用程序请求38.4kb时使用自定义除数来设置速度。
divisor        此选项设置自定义除数。
baud_base      此选项设置基准波特率。
============== =============================================================

6. 故障排除
^^^^^^^^^^^^^^^^^^

   启动时的错误消息及其解决方案尽可能表述得清晰明了。如果所有可能的解决方案都未能解决问题，请联系我们的技术支持团队寻求更多帮助。
错误消息：
	        发现超过4块Moxa Smartio/Industio系列的板卡。第五块及之后的板卡将被忽略。
解决方案：
	    为了避免此问题，请拔掉第五块及之后的板卡，因为Moxa驱动最多只支持4块板卡。
