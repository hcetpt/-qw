高速同步串行接口 (HSI)
=============================================

简介
---------------

高速同步接口 (HSI) 是一种全双工、低延迟的协议，针对应用处理器与基带芯片组之间的芯片级互联进行了优化。该协议由MIPI联盟在2003年制定，并自那时起被多个厂商实现。HSI接口支持通过多条通道（通常为8条）进行全双工通信，其速度可达到200 Mbps。串行协议使用DATA和FLAG两个信号作为组合的数据和时钟信号，并使用一个额外的READY信号进行流控制。还可以使用一个额外的WAKE信号来从待机模式唤醒芯片。信号通常以AC前缀表示从应用芯片到手机芯片的信号，而以CA前缀表示反方向的信号。
::

    +------------+                                 +---------------+
    |  手机芯片  |                                 |  应用芯片     |
    |    芯片    |                                 |      芯片     |
    |            | - - - - - - CAWAKE - - - - - - >|               |
    |           T|------------ CADATA ------------>|R              |
    |           X|------------ CAFLAG ------------>|X              |
    |            |<----------- ACREADY ------------|               |
    |            |                                 |               |
    |            |                                 |               |
    |            |< - - - - -  ACWAKE - - - - - - -|               |
    |           R|<----------- ACDATA -------------|T              |
    |           X|<----------- ACFLAG -------------|X              |
    |            |------------ CAREADY ----------->|               |
    |            |                                 |               |
    |            |                                 |               |
    +------------+                                 +---------------+

Linux中的HSI子系统
-----------------------

在Linux内核中，HSI子系统用于处理HSI设备。HSI子系统包含了HSI控制器驱动程序，包括对多端口控制器的支持，并提供了一个通用API以供使用HSI端口。此外，它还包含HSI客户端驱动程序，这些驱动程序利用通用API实现在HSI接口上使用的协议。这些客户端驱动程序可以使用任意数量的通道。

HSI字符设备
------------------

每个端口都会自动注册一个名为hsi_char的通用客户端驱动程序，它为用户空间提供了一个代表HSI端口的字符设备。用户可以通过该设备与HSI进行通信。用户可通过以下ioctl命令配置hsi_char设备：

HSC_RESET
 清空HSI端口

HSC_SET_PM
 启用或禁用客户端

HSC_SEND_BREAK
 发送中断信号

HSC_SET_RX
 设置接收配置

HSC_GET_RX
 获取接收配置

HSC_SET_TX
 设置发送配置

HSC_GET_TX
 获取发送配置

内核HSI API
------------------

.. kernel-doc:: include/linux/hsi/hsi.h
   :internal:

.. kernel-doc:: drivers/hsi/hsi_core.c
   :export:
