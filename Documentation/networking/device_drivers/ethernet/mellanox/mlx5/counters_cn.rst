### SPDX 许可证标识符：GPL-2.0 或 Linux-OpenIB
### 包含：<isonum.txt>

=================
以太工具计数器
=================

:版权所有: © 2023，NVIDIA CORPORATION 及其关联公司。保留所有权利。

### 目录

- [概述](#概述)
- [组别](#组别)
- [类型](#类型)
- [描述](#描述)

### 概述

存在多个计数器组，这些组基于计数器被记录的位置。此外，每个计数器组可能具有不同的计数器类型。这些计数器组基于网络设置中的各个组件（如下图所示）进行描述：

```
                                                      ----------------------------------------
                                                      |                                      |
    ----------------------------------------    ---------------------------------------- |
    |              虚拟机监视器              |    |                  虚拟机                  | |
    |                                      |    |                                      | |
    | -------------------  --------------- |    | -------------------  --------------- | |
    | | 以太网驱动程序 |  | RDMA 驱动程序 | |    | | 以太网驱动程序 |  | RDMA 驱动程序 | | |
    | -------------------  --------------- |    | -------------------  --------------- | |
    |           |                 |        |    |           |                 |        | |
    |           -------------------        |    |           -------------------        | |
    |                   |                  |    |                   |                  |--
    ----------------------------------------    ----------------------------------------
                        |                                           |
            -------------               -----------------------------
            |                           |
         ------                      ------ ------ ------         ------      ------      ------
    -----| PF |----------------------| VF |-| VF |-| VF |-----  --| PF |--- --| PF |--- --| PF |---
    |    ------                      ------ ------ ------    |  | ------  | | ------  | | ------  |
    |                                                        |  |         | |         | |         |
    |                                                        |  |         | |         | |         |
    |                                                        |  |         | |         | |         |
    | 电子交换机                                             |  | 电子交换机 | | 电子交换机 | | 电子交换机 |
    ----------------------------------------------------------  ----------- ----------- -----------
               -------------------------------------------------------------------------------
               |                                                                             |
               |                                                                             |
               | 上行链路（无计数器）                                                       |
               -------------------------------------------------------------------------------
                       ---------------------------------------------------------------
                       |                                                             |
                       |                                                             |
                       | MPFS（无计数器）                                            |
                       ---------------------------------------------------------------
                                                     |
                                                     |
                                                     | 端口

### 组别

**环形**
  由驱动堆栈填充的软件计数器。
**网络设备**
  环形软件计数器的汇总。
**虚拟端口计数器**
  由于转向或缺少缓冲区而产生的流量计数器和丢弃计数器。可能会指示 NIC 的问题。这些计数器包括以太网流量计数器（包括原始以太网）和 RDMA/RoCE 流量计数器。
**物理端口计数器**
  收集关于 PF 和 VF 统计信息的计数器。可能会指示 NIC、链路或网络的问题。此测量点包含关于标准化计数器的信息，如 IEEE 802.3、RFC2863、RFC 2819、RFC 3635 以及更多其他计数器，如流控制、FEC 等。物理端口计数器不会暴露给虚拟机。
**优先级端口计数器**
  按每个端口每个优先级的一组物理端口计数器。

### 类型

计数器分为三种类型：
**流量信息计数器**
  计算流量的计数器。这些计数器可用于负载估算或一般调试。
**流量加速计数器**
  计算由 Mellanox 驱动程序或硬件加速的流量的计数器。这些计数器是对信息计数器集的额外层，并且相同的流量在信息计数器和加速计数器中都有计算。
### [...#accel] 交通加速计数器
错误计数器
---
这些计数器的增加可能表明存在问题。每个计数器都有相应的解释和纠正措施。
统计信息可以通过`ip link`或`ethtool`命令获取。`ethtool`提供了更详细的信息。

```
ip –s link show <if-name>
ethtool -S <if-name>
```

描述
====
XSK、PTP 和 QoS 计数器与之前定义的计数器类似，将不再单独列出。例如，`ptp_tx[i]_packets` 不会明确记录，因为 `tx[i]_packets` 描述了这两种计数器的行为，只是当使用精确时间协议时才会计算 `ptp_tx[i]_packets`。
环/网卡计数器
------------------------
以下计数器按环或软件端口提供：
这些计数器提供了被 NIC 加速的数据量的信息。这些计数器除了标准计数器（已经进行了计数）之外还对加速流量进行计数（即，加速流量被计数两次）。
下表中的计数器名称同时适用于环和端口计数器。环计数器的表示法包含 `[i]` 索引（没有括号）。端口计数器的表示法不包含 `[i]`。一个计数器名 `rx[i]_packets` 将以 `rx0_packets` 的形式打印出来代表环 0，以及以 `rx_packets` 的形式代表软件端口。

### 环/软件端口计数器表
| 计数器       | 描述                           | 类型      |
|------------|------------------------------|---------|
| `rx[i]_packets` | 在环 i 上接收的数据包数量         | 信息性   |
| `rx[i]_bytes`   | 在环 i 上接收的字节数量           | 信息性   |
| `tx[i]_packets` | 在环 i 上发送的数据包数量         | 信息性   |
| `tx[i]_bytes`   | 在环 i 上发送的字节数量           | 信息性   |
- 信息统计

   * - `tx[i]_recover`
     - 发送队列 SQ 的恢复次数
- 错误统计

   * - `tx[i]_cqes`
     - 在发送队列 SQ 上第 i 个环发生的 CQE 事件数
- 信息统计

   * - `tx[i]_cqe_err`
     - 在发送队列 SQ 上第 i 个环遇到的错误 CQE 数量
- 错误统计

   * - `tx[i]_tso_packets`
     - 第 i 个环上发送的 TSO 数据包数量 [#accel]_
- 加速统计

   * - `tx[i]_tso_bytes`
     - 第 i 个环上发送的 TSO 字节数
- 加速统计

   * - `tx[i]_tso_inner_packets`
     - 第 i 个环上发送的带有内部封装指示的 TSO 数据包数量 [#accel]_
- 加速统计

   * - `tx[i]_tso_inner_bytes`
     - 第 i 个环上发送的带有内部封装指示的 TSO 字节数 [#accel]_
- 加速统计

   * - `rx[i]_gro_packets`
     - 使用硬件加速 GRO 处理的接收数据包数量。这里指的是在第 i 个环上接收到的硬件 GRO 卸载的数据包数量。仅统计真正的 GRO 数据包：即位于具有 GRO 计数大于 1 的 SKB 中的数据包。
- 加速统计

   * - `rx[i]_gro_bytes`
     - 使用硬件加速 GRO 处理的接收字节数。这里指的是在第 i 个环上接收到的硬件 GRO 卸载的字节数。仅统计真正的 GRO 数据包：即位于具有 GRO 计数大于 1 的 SKB 中的数据包。
- 加速统计

   * - `rx[i]_gro_skbs`
     - 从硬件加速 GRO 构建的 GRO SKB 数量。仅统计 GRO 计数大于 1 的 SKB。
- 信息性

   * - `rx[i]_gro_large_hds`
     - 使用硬件加速的GRO接收的大头部数据包的数量，这些大头部需要额外分配内存
- 信息性

   * - `rx[i]_hds_nodata_packets`
     - 在头/数据分离模式下仅包含头部的数据包数量[^accel]_
- 信息性

   * - `rx[i]_hds_nodata_bytes`
     - 在头/数据分离模式下仅包含头部的数据包的字节数量
       [^accel]_
- 信息性

   * - `rx[i]_lro_packets`
     - 在环i上接收的LRO数据包的数量[^accel]_
- 加速

   * - `rx[i]_lro_bytes`
     - 在环i上接收的LRO字节的数量[^accel]_
- 加速

   * - `rx[i]_ecn_mark`
     - 接收时ECN标记被启用的数据包数量
- 信息性

   * - `rx_oversize_pkts_buffer`
     - 因长度超出设备为入站流量分配的软件缓冲区大小而在接收队列中被丢弃的数据包数量。这可能意味着设备的MTU大于软件缓冲区大小
- 错误

   * - `rx_oversize_pkts_sw_drop`
     - 由于CQE数据大于MTU大小而在软件中被丢弃的接收数据包数量
- 错误

   * - `rx[i]_csum_unnecessary`
     - 在环i上接收到的带有`CHECKSUM_UNNECESSARY`的数据包数量[^accel]_
- 加速

   * - `rx[i]_csum_unnecessary_inner`
     - 在环i上接收到的内层封装带有`CHECKSUM_UNNECESSARY`的数据包数量[^accel]_

[^accel]: 表示与数据包处理加速相关的信息。
- 加速

   * - `rx[i]_csum_none`
     - 在环 i 上接收的带有 `CHECKSUM_NONE` 的数据包 [#accel]_
- 加速

   * - `rx[i]_csum_complete`
     - 在环 i 上接收的带有 `CHECKSUM_COMPLETE` 的数据包 [#accel]_
- 加速

   * - `rx[i]_csum_complete_tail`
     - 接收到的数据包数量，这些数据包进行了校验和计算，可能需要填充，并且能够使用 `CHECKSUM_PARTIAL` 进行处理
- 信息性

   * - `rx[i]_csum_complete_tail_slow`
     - 需要超过八字节填充以进行校验和的数据包数量
- 信息性

   * - `tx[i]_csum_partial`
     - 在环 i 上发送的带有 `CHECKSUM_PARTIAL` 的数据包 [#accel]_
- 加速

   * - `tx[i]_csum_partial_inner`
     - 在环 i 上发送的内封装带有 `CHECKSUM_PARTIAL` 的数据包 [#accel]_
- 加速

   * - `tx[i]_csum_none`
     - 在环 i 上发送的没有硬件校验和加速的数据包
- 信息性

   * - `tx[i]_stopped` / `tx_queue_stopped` [#ring_global]_
     - 环 i 上 SQ 满时发生的事件。如果这个计数器增加，请检查分配用于传输的缓冲区数量
- 信息性

   * - `tx[i]_wake` / `tx_queue_wake` [#ring_global]_
     - 环 i 上 SQ 从满变为空时发生的事件
- 信息性

   * - `tx[i]_dropped` / `tx_queue_dropped` [#ring_global]_
     - 在环 i 上由于 DMA 映射失败而丢弃的数据包。如果此计数器增加，请检查分配用于传输的缓冲区数量
- 错误

   * - `tx[i]_nop`
     - 由于循环缓冲区末尾到达而插入到 SQ（与环 i 相关）的 nop WQE（空 WQE）的数量。当接近循环缓冲区末尾时，驱动程序可能会添加这些空 WQE 以避免处理一种状态，即 WQE 开始于队列末尾并结束于队列开头。这是一种正常的情况。
- 信息

   * - `tx[i]_timestamps`
     - 在设备的 DMA 层被硬件时间戳的已传输数据包数量
- 信息

   * - `tx[i]_added_vlan_packets`
     - 已发送的数据包中，其中 VLAN 标签插入被卸载到硬件的数量
- 加速

   * - `rx[i]_removed_vlan_packets`
     - 接收的数据包中，其中 VLAN 标签剥离被卸载到硬件的数量
- 加速

   * - `rx[i]_wqe_err`
     - 环 i 上接收到的错误操作码的数量
- 错误

   * - `rx[i]_mpwqe_frag`
     - 未能分配复合页面而导致使用了分段 MPWQE（多数据包 WQE）的 WQE 数量。如果此计数器增加，可能表明没有足够的内存用于大型页面，驱动程序分配了分段页面。这不是异常情况。
- 信息

   * - `rx[i]_mpwqe_filler_cqes`
     - 在环 i 上发布的填充 CQE 事件的数量
- 信息

   * - `rx[i]_mpwqe_filler_strides`
     - 在环 i 上由填充 CQE 消耗的步长数量
- 信息

   * - `tx[i]_mpwqe_blks`
     - 从 Multi-Packet WQEs (mpwqe) 处理的发送块数量
- 信息

   * - `tx[i]_mpwqe_pkts`
     - 从 Multi-Packet WQEs (mpwqe) 处理的发送数据包数量
- 信息统计

   * - `rx[i]_cqe_compress_blks`
     - 环i上带有CQE压缩的接收块数量 [#加速]_
- 加速

   * - `rx[i]_cqe_compress_pkts`
     - 环i上带有CQE压缩的接收数据包数量 [#加速]_
- 加速

   * - `rx[i]_arfs_add`
     - 为直接RQ导向而添加到设备上的aRFS流规则数量（针对环i） [#加速]_
- 加速

   * - `rx[i]_arfs_request_in`
     - 请求移动进入环i以进行直接RQ导向的流规则数量 [#加速]_
- 加速

   * - `rx[i]_arfs_request_out`
     - 请求移出环i的流规则数量 [#加速]_
- 加速

   * - `rx[i]_arfs_expired`
     - 已过期并被移除的流规则数量 [#加速]_
- 加速

   * - `rx[i]_arfs_err`
     - 未能成功添加到流表中的流规则数量
- 错误

   * - `rx[i]_recover`
     - RQ恢复次数
- 错误

   * - `tx[i]_xmit_more`
     - 使用`xmit_more`标志发送的数据包数量，该标志设置在skbuff中（不敲门铃）
- 加速

   * - `ch[i]_poll`
     - 对通道i的NAPI轮询调用次数
- 信息统计

   * - `ch[i]_arm`
     - 通道 i 上 NAPI 轮询函数完成并启动完成队列的次数
- 信息统计

   * - `ch[i]_aff_change`
     - 由于亲和性变化，NAPI 轮询函数在通道 i 上明确停止某个 CPU 执行的次数
- 信息统计

   * - `ch[i]_events`
     - 通道 i 的完成队列上的硬中断事件数量
- 信息统计

   * - `ch[i]_eq_rearm`
     - 完成队列恢复的次数
- 错误统计

   * - `ch[i]_force_irq`
     - 通过向 ICOSQ 发送 NOP 来触发 NAPI 的 XSK 唤醒次数
- 加速统计

   * - `rx[i]_congst_umr`
     - 由于拥塞导致环 i 上的 UMR 请求延迟的次数
- 信息统计

   * - `rx_pp_alloc_fast`
     - 成功的快速路径分配次数
- 信息统计

   * - `rx_pp_alloc_slow`
     - 慢速路径的 0 级分配次数
- 信息统计

   * - `rx_pp_alloc_slow_high_order`
     - 慢速路径的高级别分配次数
- 信息统计

   * - `rx_pp_alloc_empty`
     - 当指针环为空时，该计数器增加，因此被迫进行慢速路径分配
- 信息性

   * - `rx_pp_alloc_refill`
     - 当触发缓存填充的分配发生时，计数器递增
- 信息性

   * - `rx_pp_alloc_waive`
     - 当从指针环获取的页面由于NUMA不匹配而无法添加到缓存中时，计数器递增
- 信息性

   * - `rx_pp_recycle_cached`
     - 当在页面池缓存中循环使用页面时，计数器递增
- 信息性

   * - `rx_pp_recycle_cache_full`
     - 当页面池缓存已满时，计数器递增
- 信息性

   * - `rx_pp_recycle_ring`
     - 当页面放置到指针环中时，计数器递增
- 信息性

   * - `rx_pp_recycle_ring_full`
     - 当指针环已满导致页面从页面池释放时，计数器递增
- 信息性

   * - `rx_pp_recycle_released_ref`
     - 当引用计数大于1时页面被释放（而非循环使用）时，计数器递增
- 信息性

   * - `rx[i]_xsk_buff_alloc_err`
     - 在XSK接收队列上下文中分配skb或XSK缓冲失败的次数
- 错误

   * - `rx[i]_xdp_tx_xmit`
     - 由于XDP程序的`XDP_TX`操作（反弹）而转发回端口的数据包数量。这些数据包不被其他软件计数器统计。这些数据包由物理端口和虚拟端口计数器统计
- 信息性

   * - `rx[i]_xdp_tx_mpwqe`
     - 在接收队列上下文中，由网卡传输的多包WQE的数量以及通过`XDP_TX`操作由网卡处理的数量
- 加速

  * - `rx[i]_xdp_tx_inlnw`
    - 在接收队列上下文中通过`XDP_TX`传输的数据段中，数据能够内联在工作队列元素(WQE)中的数量
- 加速

  * - `rx[i]_xdp_tx_nops`
    - 发送到XDP发送队列(SQ)的空操作(NOP)工作队列构建块(WQEBB)的数量
- 加速

  * - `rx[i]_xdp_tx_full`
    - 应通过`XDP_TX`动作转发回端口但由于发送队列满而被丢弃的数据包数量。这些数据包不被其他软件计数器统计。这些数据包按物理端口和虚拟端口计数器进行统计。您可以开启更多的接收队列并使流量在所有队列上分布均匀，或者增加接收环的大小
- 错误

  * - `rx[i]_xdp_tx_err`
    - 在接收(RX)环的`XDP_TX`环上发生的错误次数，如帧太长或帧太短
- 错误

  * - `rx[i]_xdp_tx_cqes` / `rx_xdp_tx_cqe` [#ring_global]_
    - 在`XDP_TX`环的完成队列(CQ)上接收到的完成数量
- 信息性

  * - `rx[i]_xdp_drop`
    - 因XDP程序的`XDP_DROP`动作而被丢弃的数据包数量。这些数据包不被其他软件计数器统计。这些数据包按物理端口和虚拟端口计数器进行统计
- 信息性

  * - `rx[i]_xdp_redirect`
    - 在接收环i上触发XDP重定向动作的次数
- 加速

  * - `tx[i]_xdp_xmit`
    - 被重定向到接口(由于XDP重定向)的数据包数量。这些数据包不被其他软件计数器统计。这些数据包按物理端口和虚拟端口计数器进行统计
- 信息性

  * - `tx[i]_xdp_full`
    - 被重定向到接口(由于XDP重定向)，但由于发送队列满而被丢弃的数据包数量。这些数据包不被其他软件计数器统计。您可以扩大发送队列的大小
- 信息统计
   * - `tx[i]_xdp_mpwqe`
     - 从其他网络设备通过 `XDP_REDIRECT` 转发到网卡的多包工作队列条目 (WQE) 的数量
- 加速
   * - `tx[i]_xdp_inlnw`
     - 数据能够内联在工作队列条目 (WQE) 中的数据段的数量，这些数据段是从其他网络设备通过 `XDP_REDIRECT` 转发的
- 加速
   * - `tx[i]_xdp_nops`
     - 由于从其他网络设备通过 `XDP_REDIRECT` 转发而发布到发送队列 (SQ) 的空操作 (NOP) 工作队列构建块 (WQEBB) 的数量
- 加速
   * - `tx[i]_xdp_err`
     - 因错误（如帧过长或过短）而被丢弃的、通过 XDP 重定向到接口的报文数量
- 错误
   * - `tx[i]_xdp_cqes`
     - 在完成队列 (CQ) 上接收到的、因 XDP 重定向到接口的报文完成的数量
- 信息统计
   * - `tx[i]_xsk_xmit`
     - 使用 XSK 零拷贝功能传输的报文数量
- 加速
   * - `tx[i]_xsk_mpwqe`
     - 从其他网络设备通过 `XDP_REDIRECT` 转发到网卡的多包工作队列条目 (WQE) 的数量
- 加速
   * - `tx[i]_xsk_inlnw`
     - 数据能够内联在工作队列条目 (WQE) 中的数据段的数量，这些数据段是使用 XSK 零拷贝功能传输的
- 加速
   * - `tx[i]_xsk_full`
     - 当发送队列 (SQ) 满时，在 XSK 零拷贝模式下触发门铃机制的次数
- 错误
   * - `tx[i]_xsk_err`
     - 在 XSK 零拷贝模式下发生的错误数量，例如数据大小超过最大传输单元 (MTU) 大小的情况
错误

   * - `tx[i]_xsk_cqes`
     - 在XSK零拷贝模式下处理的CQE数量
- 加速

   * - `tx_tls_ctx`
     - 添加到设备以进行加密的TLS发送硬件卸载上下文的数量
- 加速

   * - `tx_tls_del`
     - 从设备中移除的TLS发送硬件卸载上下文的数量（连接关闭）
- 加速

   * - `tx_tls_pool_alloc`
     - 在TLS硬件卸载池中成功分配工作单元的次数
- 加速

   * - `tx_tls_pool_free`
     - 在TLS硬件卸载池中释放工作单元的次数
- 加速

   * - `rx_tls_ctx`
     - 添加到设备以进行解密的TLS接收硬件卸载上下文的数量
- 加速

   * - `rx_tls_del`
     - 从设备中删除的TLS接收硬件卸载上下文的数量（连接已完成）
- 加速

   * - `rx[i]_tls_decrypted_packets`
     - 成功解密的属于TLS流的接收数据包数量
- 加速

   * - `rx[i]_tls_decrypted_bytes`
     - 成功解密的接收数据包中的TLS有效负载字节数量
- 加速

   * - `rx[i]_tls_resync_req_pkt`
     - 收到的带有重新同步请求的TLS数据包数量
- 加速

  * - `rx[i]_tls_resync_req_start`
    - 开始 TLS 异步重同步请求的次数
- 加速

  * - `rx[i]_tls_resync_req_end`
    - TLS 异步重同步请求正确结束并提供硬件追踪的 TCP 序号的次数
- 加速

  * - `rx[i]_tls_resync_req_skip`
    - TLS 异步重同步请求过程开始但未正确结束的次数
- 错误

  * - `rx[i]_tls_resync_res_ok`
    - 成功处理驱动程序中的 TLS 重同步响应调用的次数
- 加速

  * - `rx[i]_tls_resync_res_retry`
    - 当 ICOSQ 已满时，重新尝试驱动程序中的 TLS 重同步响应调用的次数
- 错误

  * - `rx[i]_tls_resync_res_skip`
    - 驱动程序中的 TLS 重同步响应调用未能成功终止的次数
- 错误

  * - `rx[i]_tls_err`
    - CQE TLS 卸载出现问题的次数
- 错误

  * - `tx[i]_tls_encrypted_packets`
    - 由内核进行 TLS 加密的发送数据包的数量
- 加速

  * - `tx[i]_tls_encrypted_bytes`
    - 由内核进行 TLS 加密的发送字节的数量
- 加速

  * - `tx[i]_tls_ooo`
    - 在环 i 上处理无序的 TLS SQE 分片的次数
- 加速

  * - `tx[i]_tls_dump_packets`
    - 通过直接内存访问（DMA）从网络接口控制器（NIC）复制的已解密TLS数据包数量
- 加速

  * - `tx[i]_tls_dump_bytes`
    - 通过直接内存访问（DMA）从网络接口控制器（NIC）复制的已解密TLS字节数量
- 加速

  * - `tx[i]_tls_resync_bytes`
    - 请求重新同步以进行解密的TLS字节数量
- 加速

  * - `tx[i]_tls_skip_no_sync_data`
    - 可安全跳过或无需解密的TLS发送数据数量
- 加速

  * - `tx[i]_tls_drop_no_sync_data`
    - 因为TLS数据重传而丢弃的TLS发送数据数量
- 加速

  * - `ptp_cq[i]_abort`
    - 在精确时间协议中，由于端口时间戳与CQE时间戳之间的偏差大于128秒而导致需要跳过的完成队列条目（CQE）次数
- 错误

  * - `ptp_cq[i]_abort_abs_diff_ns`
    - 在精确时间协议中，当端口时间戳与CQE时间戳之间的差值大于128秒时，这些时间差值的累积
- 错误

  * - `ptp_cq[i]_late_cqe`
    - 在精确时间协议中，当某个预期时间内不应该有CQE送达，但实际上却送达了CQE的次数
- 错误

  * - `ptp_cq[i]_lost_cqe`
    - 在精确时间协议中，由于时间间隔已过，预期不会送达但设备实际上未送达的CQE数量。如果这种CQE被送达，则会递增`ptp_cq[i]_late_cqe`

.. [#ring_global] 相应的环形缓冲区和全局计数器名称并不相同（即不遵循通用命名方案）。
### vPort 计数器
--------------
连接到 eSwitch 的 NIC 端口上的计数器。

.. flat-table:: vPort 计数器表
   :widths: 2 3 1

   * - 计数器
     - 描述
     - 类型

   * - `rx_vport_unicast_packets`
     - 接收到的单播数据包，导向端口包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `rx_vport_unicast_bytes`
     - 接收到的单播字节数，导向端口包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `tx_vport_unicast_packets`
     - 发送的单播数据包，从端口导向出去包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `tx_vport_unicast_bytes`
     - 发送的单播字节数，从端口导向出去包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `rx_vport_multicast_packets`
     - 接收到的多播数据包，导向端口包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `rx_vport_multicast_bytes`
     - 接收到的多播字节数，导向端口包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `tx_vport_multicast_packets`
     - 发送的多播数据包，从端口导向出去包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `tx_vport_multicast_bytes`
     - 发送的多播字节数，从端口导向出去包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性

   * - `rx_vport_broadcast_packets`
     - 接收到的广播数据包，导向端口包括原始以太网 QP/DPDK 流量，不包括 RDMA 流量
- 信息性
- 信息性

   * - `rx_vport_broadcast_bytes`
     - 接收到的广播字节数，导向至端口，包括原始以太网QP/DPDK流量，不包括RDMA流量
- 信息性

   * - `tx_vport_broadcast_packets`
     从端口发出的广播数据包数，包括原始以太网QP/DPDK流量，不包括RDMA流量
- 信息性

   * - `tx_vport_broadcast_bytes`
     从端口发出的广播字节数，包括原始以太网QP/DPDK流量，不包括RDMA流量
- 信息性

   * - `rx_vport_rdma_unicast_packets`
     接收到的RDMA单播数据包数，导向至端口（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `rx_vport_rdma_unicast_bytes`
     接收到的RDMA单播字节数，导向至端口（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `tx_vport_rdma_unicast_packets`
     从端口发出的RDMA单播数据包数（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `tx_vport_rdma_unicast_bytes`
     从端口发出的RDMA单播字节数（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `rx_vport_rdma_multicast_packets`
     接收到的RDMA多播数据包数，导向至端口（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `rx_vport_rdma_multicast_bytes`
     接收到的RDMA多播字节数，导向至端口（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `tx_vport_rdma_multicast_packets`
     从端口发出的RDMA多播数据包数（计数器统计RoCE/UD/RC流量） [#accel]_
- 加速

   * - `tx_vport_rdma_multicast_bytes`
     - 从端口转发的RDMA多播字节数（计数器统计RoCE/UD/RC流量）[#accel]_
- 加速

   * - `vport_loopback_packets`
     - 环回的单播、多播和广播数据包（接收并发送），IB/以太网  [#accel]_
- 加速

   * - `vport_loopback_bytes`
     - 环回的单播、多播和广播字节（接收并发送），IB/以太网  [#accel]_
- 加速

   * - `rx_steer_missed_packets`
     - NIC接收到但因未匹配NIC流表中的任何流而被丢弃的数据包数量
- 错误

   * - `rx_packets`
     - 仅表示器：由虚拟机监控程序处理的接收到的数据包
- 信息性

   * - `rx_bytes`
     - 仅表示器：由虚拟机监控程序处理的接收到的字节数
- 信息性

   * - `tx_packets`
     - 仅表示器：由虚拟机监控程序处理的传输的数据包
- 信息性

   * - `tx_bytes`
     - 仅表示器：由虚拟机监控程序处理的传输的字节数
- 信息性

   * - `dev_internal_queue_oob`
     - 因内部设备接收队列缺少接收WQEs而导致丢弃的数据包数量
- 错误

物理端口计数器
----------------------
物理端口计数器是在适配器与网络连接的外部端口上的计数器。这个测量点包含了标准化计数器的信息，如IEEE 802.3、RFC2863、RFC 2819、RFC 3635以及额外的计数器，例如流控制、FEC等。
物理端口计数器表
=================

| 计数器 | 描述 | 类型 |
| --- | --- | --- |
| `rx_packets_phy` | 物理端口接收到的数据包数量。此计数器不包括因FCS（帧校验序列）、帧大小等类似错误而被丢弃的数据包 | 信息性 |
| `tx_packets_phy` | 物理端口发送的数据包数量 | 信息性 |
| `rx_bytes_phy` | 物理端口接收到的字节数，包括以太网头部和FCS | 信息性 |
| `tx_bytes_phy` | 物理端口发送的字节数 | 信息性 |
| `rx_multicast_phy` | 物理端口接收到的多播数据包数量 | 信息性 |
| `tx_multicast_phy` | 物理端口发送的多播数据包数量 | 信息性 |
| `rx_broadcast_phy` | 物理端口接收到的广播数据包数量 | 信息性 |
| `tx_broadcast_phy` | 物理端口发送的广播数据包数量 | 信息性 |
| `rx_crc_errors_phy` | 因FCS（帧校验序列）错误而导致在物理端口丢弃的接收数据包数量。如果此计数器以高速增加，请使用下面的`rx_symbol_error_phy`和`rx_corrected_bits_phy`计数器检查链路质量 | 错误 |
| `rx_in_range_len_errors_phy` | 因长度/类型错误而在物理端口丢弃的接收数据包数量 | 信息性 |
- 错误

   * - `rx_out_of_range_len_phy`
     - 由于接收到的数据包长度超过物理端口允许的最大值而导致被丢弃的数据包数量。如果此计数器在增加，这意味着与适配器相连的对端配置了更大的MTU。使用相同的MTU配置可以解决此问题。
- 错误

   * - `rx_oversize_pkts_phy`
     - 由于接收到的数据包长度超过了物理端口上的MTU大小而被丢弃的数据包数量。如果此计数器在增加，这意味着与适配器相连的对端配置了更大的MTU。使用相同的MTU配置可以解决此问题。
- 错误

   * - `rx_symbol_err_phy`
     - 由于物理编码错误（符号错误）而在物理端口上被丢弃的接收数据包数量。
- 错误

   * - `rx_mac_control_phy`
     - 在物理端口上接收到的MAC控制数据包的数量。
- 信息

   * - `tx_mac_control_phy`
     - 在物理端口上传输的MAC控制数据包的数量。
- 信息

   * - `rx_pause_ctrl_phy`
     - 在物理端口上接收到的链路层暂停数据包的数量。如果此计数器在增加，这意味着网络拥塞且无法吸收来自适配器的流量。
- 信息

   * - `tx_pause_ctrl_phy`
     - 在物理端口上传输的链路层暂停数据包的数量。如果此计数器在增加，这意味着NIC拥塞且无法吸收来自网络的流量。
- 信息

   * - `rx_unsupported_op_phy`
     - 在物理端口上接收到的带有不受支持的操作码的MAC控制数据包的数量。
- 错误

   * - `rx_discards_phy`
     - 由于物理端口缺少缓冲区而导致被丢弃的接收数据包数量。如果此计数器在增加，这意味着适配器拥塞且无法吸收来自网络的流量。
- 错误

   * - `tx_discards_phy`
     - 即使未检测到任何错误，在传输过程中被丢弃的数据包数量。丢弃可能由于链路处于断开状态、队列头部丢弃、网络暂停等原因发生。
- 错误

   * - `tx_errors_phy`
     - 由于物理端口上发送的数据包长度超过最大传输单元（MTU）大小而导致被丢弃的发送数据包数量
- 错误

   * - `rx_undersize_pkts_phy`
     - 由于物理端口上接收的数据包长度短于64字节而被丢弃的接收数据包数量。如果这个计数器在增加，意味着与适配器相连的对等体配置了非标准MTU或收到了畸形数据包
- 错误

   * - `rx_fragments_phy`
     - 由于物理端口上接收的数据包长度短于64字节且存在帧校验序列（FCS）错误而被丢弃的接收数据包数量。如果这个计数器在增加，意味着与适配器相连的对等体配置了非标准MTU
- 错误

   * - `rx_jabbers_phy`
     - 由于物理端口上接收的数据包长度长于64字节且存在帧校验序列（FCS）错误而被丢弃的接收数据包数量
- 错误

   * - `rx_64_bytes_phy`
     - 在物理端口上接收到的大小为64字节的数据包数量
- 信息性

   * - `rx_65_to_127_bytes_phy`
     - 在物理端口上接收到的大小为65到127字节的数据包数量
- 信息性

   * - `rx_128_to_255_bytes_phy`
     - 在物理端口上接收到的大小为128到255字节的数据包数量
- 信息性

   * - `rx_256_to_511_bytes_phy`
     - 在物理端口上接收到的大小为256到512字节的数据包数量
- 信息性

   * - `rx_512_to_1023_bytes_phy`
     - 在物理端口上接收到的大小为512到1023字节的数据包数量
- 信息性

   * - `rx_1024_to_1518_bytes_phy`
     - 在物理端口上接收到的大小为1024到1518字节的数据包数量
- 信息性指标

   * - `rx_1519_to_2047_bytes_phy`
     - 物理端口接收到的大小在 1519 到 2047 字节之间的数据包数量
- 信息性指标

   * - `rx_2048_to_4095_bytes_phy`
     - 物理端口接收到的大小在 2048 到 4095 字节之间的数据包数量
- 信息性指标

   * - `rx_4096_to_8191_bytes_phy`
     - 物理端口接收到的大小在 4096 到 8191 字节之间的数据包数量
- 信息性指标

   * - `rx_8192_to_10239_bytes_phy`
     - 物理端口接收到的大小在 8192 到 10239 字节之间的数据包数量
- 信息性指标

   * - `link_down_events_phy`
     - 链路工作状态变为不可用的次数。如果此计数器持续增加，可能表明端口出现频繁切换状态的问题。您可能需要更换线缆/收发器
- 错误指标

   * - `rx_out_of_buffer`
     - 接收队列中没有为适配器的传入流量分配软件缓冲区的次数
- 错误指标

   * - `module_bus_stuck`
     - 检测到模块的 I\ :sup:`2`\C 总线（数据或时钟）出现短路的次数。您可能需要更换线缆/收发器
- 错误指标

   * - `module_high_temp`
     - 模块温度过高的次数。如果此问题持续存在，您可能需要检查环境温度或更换线缆/收发器模块
- 错误指标

   * - `module_bad_shorted`
     - 模块线缆短路的次数。您可能需要更换线缆/收发器模块
- 错误指标

   * - `module_unplug`
     - 模块被拔出的次数
- 信息性

   * - `rx_buffer_passed_thres_phy`
     - 端口接收缓冲区超过85%满的事件数量
- 信息性

   * - `tx_pause_storm_warning_events`
     - 设备长时间发送暂停帧的次数
- 信息性

   * - `tx_pause_storm_error_events`
     - 设备长时间发送暂停帧，达到超时并禁用暂停帧传输的次数。在暂停帧被禁用的期间，可能会发生丢包
- 错误

   * - `rx[i]_buff_alloc_err`
     - 在环i上未能分配接收数据包（或SKB）的缓冲区
- 错误

   * - `rx_bits_phy`
     - 此计数器提供有关可以接收的总流量的信息，可用作衡量`rx_pcs_symbol_err_phy`和`rx_corrected_bits_phy`中错误流量比例的参考指标
- 信息性

   * - `rx_pcs_symbol_err_phy`
     - 此计数器统计未被FEC校正算法纠正的符号错误数量，或者此接口上FEC算法未激活的情况。如果此计数器在增加，则表明NIC与网络之间的链路遭受高误码率，且有流量丢失。可能需要更换线缆/收发器。误码率是在特定时间框架内`rx_pcs_symbol_err_phy`的数量除以`rx_bits_phy`的数量
- 错误

   * - `rx_corrected_bits_phy`
     - 根据激活的FEC（RS/FC）算法，此端口上的已纠正位数量。如果此计数器在增加，则表明NIC与网络之间的链路遭受高误码率。已纠正的比特率是在特定时间框架内`rx_corrected_bits_phy`的数量除以`rx_bits_phy`的数量
- 错误

   * - `rx_err_lane_[l]_phy`
     - 按车道l索引统计物理原始错误数量。此计数器统计的是FEC校正之前的错误。如果此计数器在增加，则表明NIC与网络之间的链路遭受高误码率，且可能会有流量丢失。可能需要更换线缆/收发器。请参照`rx_corrected_bits_phy`进行检查
- 错误

   * - `rx_global_pause`
     - 物理端口接收到的暂停帧数量。如果此计数器在增加，则表明网络拥塞，无法吸收适配器发出的流量。注意：仅当启用全局暂停模式时，此计数器才有效
- 信息性指标

   * - `rx_global_pause_duration`
     - 物理端口接收到的暂停持续时间（以微秒为单位）。该计数器代表了端口未发送任何流量的时间。如果此计数器在增加，这意味着网络拥塞且无法吸收来自适配器的流量。注意：此计数器仅在启用全局暂停模式时有效。
- 信息性指标

   * - `tx_global_pause`
     - 物理端口传输的暂停数据包数量。如果此计数器在增加，这意味着适配器拥塞且无法吸收来自网络的流量。注意：此计数器仅在启用全局暂停模式时有效。
- 信息性指标

   * - `tx_global_pause_duration`
     - 物理端口上的暂停发送器持续时间（以微秒为单位）。
注意：此计数器仅在启用全局暂停模式时有效。
- 信息性指标

   * - `rx_global_pause_transition`
     - 物理端口上从Xoff到Xon状态转换的次数。
注意：此计数器仅在启用全局暂停模式时有效。
- 信息性指标

   * - `rx_if_down_packets`
     - 接收后因接口关闭而丢弃的数据包数量。

优先级端口计数器
----------------------
以下是按照L2优先级（0-7）对物理端口进行计数的计数器。
**注释：** 计数器名称中的`p`代表优先级
.. flat-table:: 优先级端口计数器表
   :widths: 2 3 1

   * - 计数器
     - 描述
     - 类型

   * - `rx_prio[p]_bytes`
     - 物理端口接收到的具有优先级p的字节数
- 信息性指标

   * - `rx_prio[p]_packets`
     - 物理端口接收到的具有优先级p的数据包数量
- 信息性指标

   * - `tx_prio[p]_bytes`
     - 在物理端口上以优先级 p 发送的字节数
- 信息性指标

   * - `tx_prio[p]_packets`
     - 在物理端口上以优先级 p 发送的数据包数
- 信息性指标

   * - `rx_prio[p]_pause`
     - 在物理端口上接收到的带有优先级 p 的暂停数据包数。如果此计数器在增加，则表明网络拥塞，无法吸收来自适配器的流量。注意：此计数器仅在优先级 p 上启用了PFC时可用。
- 信息性指标

   * - `rx_prio[p]_pause_duration`
     - 在物理端口上接收到的优先级 p 暂停持续时间（微秒）。该计数器表示端口在这个优先级上未发送任何流量的时间。如果此计数器在增加，则表明网络拥塞，无法吸收来自适配器的流量。注意：此计数器仅在优先级 p 上启用了PFC时可用。
- 信息性指标

   * - `rx_prio[p]_pause_transition`
     - 物理端口上优先级 p 从 Xoff 到 Xon 的转换次数。注意：此计数器仅在优先级 p 上启用了PFC时可用。
- 信息性指标

   * - `tx_prio[p]_pause`
     - 在物理端口上以优先级 p 发送的暂停数据包数。如果此计数器在增加，则表明适配器拥塞，无法吸收来自网络的流量。注意：此计数器仅在优先级 p 上启用了PFC时可用。
- 信息性指标

   * - `tx_prio[p]_pause_duration`
     - 在物理端口上以优先级 p 发送的暂停持续时间（微秒）。注意：此计数器仅在优先级 p 上启用了PFC时可用。
- 信息性指标

   * - `rx_prio[p]_buf_discard`
     - 由于缺少每主机接收缓冲区而导致设备丢弃的数据包数
### 信息性指标

* **`rx_prio[p]_cong_discard`**
  * 因主机级拥塞导致设备丢弃的数据包数量。
* **`rx_prio[p]_marked`**
  * 因主机级拥塞导致设备进行ECN标记的数据包数量。
* **`rx_prio[p]_discards`**
  * 因接收缓冲区不足导致设备丢弃的数据包数量。

### 设备计数器
#### 设备计数器表
| 计数器 | 描述 | 类型 |
| --- | --- | --- |
| `rx_pci_signal_integrity` | 计数物理层PCIe信号完整性错误，因帧错误和CRC（dlp和tlp）导致的恢复状态转换次数。如果此计数器数值上升，请尝试将适配卡移动到其他插槽以排除故障PCI插槽的可能性。验证是否正在使用最新的固件版本及服务器BIOS版本。 | 信息性 |
| `tx_pci_signal_integrity` | 计数物理层PCIe信号完整性错误，因另一端发起的转换到恢复状态（由于接收到TS/EIEOS）的数量。如果此计数器数值上升，请尝试将适配卡移动到其他插槽以排除故障PCI插槽的可能性。验证是否正在使用最新的固件版本及服务器BIOS版本。 | 错误 |
| `outbound_pci_buffer_overflow` | 因PCI缓冲区溢出而丢弃的数据包数量。如果此计数器数值快速上升，可能表明对某个主机的接收流量速率大于PCIe总线速率，从而导致拥塞。 | 信息性 |
| `outbound_pci_stalled_rd` | 在过去一秒内NIC有未发布读请求但因未发布信用额度不足无法执行操作的时间百分比（范围为0至100）。 | 信息性 |
| `outbound_pci_stalled_wr` | 在过去一秒内NIC有已发布写请求但因未发布信用额度不足无法执行操作的时间百分比（范围为0至100）。 | 信息性 |
| `outbound_pci_stalled_rd_events` | `outbound_pci_stalled_rd`超过30%的秒数。 | 信息性 |
| `outbound_pci_stalled_wr_events` | `outbound_pci_stalled_wr`超过30%的秒数。 | 信息性 |
- 信息

   * - `dev_out_of_buffer`
     - 设备所有队列因未分配足够缓冲区而导致的次数
- 错误
