SPDX 许可证标识符: GPL-2.0

=====================
mlxsw devlink 支持
=====================

本文档描述了由 ``mlxsw`` 设备驱动程序实现的 devlink 功能。
参数
==========

.. list-table:: 实现的通用参数

   * - 名称
     - 模式
   * - ``fw_load_policy``
     - driverinit

``mlxsw`` 驱动程序还实现了以下特定于驱动程序的参数：
.. list-table:: 实现的特定于驱动程序的参数
   :widths: 5 5 5 85

   * - 名称
     - 类型
     - 模式
     - 描述
   * - ``acl_region_rehash_interval``
     - u32
     - 运行时
     - 设置定期进行 ACL 区域重新哈希的时间间隔。值以毫秒为单位指定，最小为 ``3000``。值为 ``0`` 则完全禁用定期任务。设置后将立即执行第一次重新哈希。

``mlxsw`` 驱动程序支持通过 ``DEVLINK_CMD_RELOAD`` 进行重载。

信息版本
=============

``mlxsw`` 驱动程序报告以下版本信息：

.. list-table:: 实现的 devlink 信息版本
   :widths: 5 5 90

   * - 名称
     - 类型
     - 描述
   * - ``hw.revision``
     - 固定
     - 该板卡的硬件修订版
   * - ``fw.psid``
     - 固定
     - 固件 PSID
   * - ``fw.version``
     - 运行中
     - 三位数固件版本

线路卡辅助设备信息版本
========================================

``mlxsw`` 驱动程序报告以下线路卡辅助设备的信息版本：

.. list-table:: 实现的 devlink 信息版本
   :widths: 5 5 90

   * - 名称
     - 类型
     - 描述
   * - ``hw.revision``
     - 固定
     - 该线路卡的硬件修订版
   * - ``ini.version``
     - 运行中
     - 加载的线路卡 INI 版本
   * - ``fw.psid``
     - 固定
     - 线路卡设备 PSID
   * - ``fw.version``
     - 运行中
     - 线路卡设备的三位数固件版本

特定于驱动程序的陷阱
=====================

.. list-table:: 由 ``mlxsw`` 注册的特定于驱动程序的陷阱列表
   :widths: 5 5 90

   * - 名称
     - 类型
     - 描述
   * - ``irif_disabled``
     - ``drop``
     - 捕获设备决定丢弃的需要从已禁用的路由器接口（RIF）路由的数据包。这可能发生在 RIF 拆除期间，当 RIF 首先被禁用然后再完全移除时。
   * - ``erif_disabled``
     - ``drop``
     - 捕获设备决定丢弃的需要通过已禁用的路由器接口（RIF）路由的数据包。这可能发生在 RIF 拆除期间，当 RIF 首先被禁用然后再完全移除时。
