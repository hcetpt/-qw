### SPDX 许可证标识符: GPL-2.0

#### SMC Sysctl

##### /proc/sys/net/smc/* 变量

- **autocorking_size - 整数**
  - 设置 SMC 自动捆绑大小：
    - SMC 自动捆绑从应用程序的角度来看类似于 TCP 的自动捆绑。当应用程序进行连续的小型 write()/sendmsg() 系统调用时，我们尽量将这些小型写操作尽可能地合并，以减少发送的 CDC 和 RDMA 写操作总数。
  - `autocorking_size` 限制了单次发送中可以向底层设备发送的最大捆绑字节数。如果设置为 0，则禁用 SMC 自动捆绑功能。
  - 应用程序仍然可以在了解如何及何时解除捆绑的情况下使用 TCP_CORK 来获得最佳性能。
  - 默认值：64K

- **smcr_buf_type - 整数**
  - 控制在后续新创建的 SMC-R 链路组中使用的 sndbufs 和 RMBs 的类型。仅适用于 SMC-R。
  - 默认值：0（物理上连续的 sndbufs 和 RMBs）
  
  - 可能的值：
    - 0 - 使用物理上连续的缓冲区
    - 1 - 使用虚拟上连续的缓冲区
    - 2 - 混合使用这两种类型。首先尝试使用物理上连续的缓冲区，如果不可用，则使用虚拟上连续的缓冲区。

- **smcr_testlink_time - 整数**
  - SMC-R 链路发送 TEST_LINK LLC 消息以确认其可用性的频率，该频率是在链路上最后一次活动后的时间间隔。值为 0 表示禁用 TEST_LINK。
  - 默认值：30 秒

- **wmem - 整数**
  - SMC 套接字使用的发送缓冲区初始大小。
  - 最小值为 16KiB，并且最大值没有硬性限制，但对于 SMC-R 允许的最大值为 512KiB，对于 SMC-D 为 1MiB。
默认值：64KiB

rmem - 整数
SMC 套接字用于接收缓冲区（RMB）的初始大小
最小值为 16KiB，并且最大值没有硬性限制，但是
对于 SMC-R 允许的最大值为 512KiB，对于 SMC-D 则为 1MiB
默认值：64KiB

smcr_max_links_per_lgr - 整数
控制可以添加到 SMC-R 链路组中的最大链接数。请注意，
实际上添加到 SMC-R 链路组中的链接数量取决于系统中存在的
RDMA 设备的数量。可接受的值范围是从 1 到 2。仅适用于 SMC-R v2.1 及更高版本
默认值：2

smcr_max_conns_per_lgr - 整数
控制可以添加到 SMC-R 链路组中的最大连接数。可接受的值范围从 16 到 255。
仅适用于 SMC-R v2.1 及更高版本
默认值：255
