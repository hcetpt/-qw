===================================
NetLabel CIPSO/IPv4 协议引擎
===================================

Paul Moore, paul.moore@hp.com

2006年5月17日

概述
========

NetLabel CIPSO/IPv4 协议引擎基于1992年7月16日的IETF商业IP安全选项（CIPSO）草案。该草案的副本可以在本目录中找到（draft-ietf-cipso-ipsecurity-01.txt）。虽然IETF草案从未成为RFC标准，但它已经成为标记网络的事实标准，并被许多可信操作系统采用。

出站数据包处理
==========================

CIPSO/IPv4协议引擎通过向套接字添加CIPSO IP选项来应用CIPSO IP选项。这会导致所有通过该套接字离开系统的数据包都应用CIPSO IP选项。套接字的CIPSO标签可以随时更改，但建议在创建套接字时设置。LSM可以通过使用NetLabel安全模块API来设置套接字的CIPSO标签；如果配置了NetLabel“域”以使用CIPSO进行数据包标记，则会生成并附加一个CIPSO IP选项。

入站数据包处理
=========================

CIPSO/IPv4协议引擎会在IP层验证其发现的每个CIPSO IP选项，无需LSM进行特殊处理。但是，为了解码和转换数据包上的CIPSO标签，LSM必须使用NetLabel安全模块API来提取数据包的安全属性。这通常在套接字层通过'socket_sock_rcv_skb()' LSM钩子完成。

标签转换
=================

CIPSO/IPv4协议引擎包含一种机制，用于将CIPSO安全属性（如敏感级别和类别）转换为主机适用的值。这些映射是作为CIPSO解释域（DOI）定义的一部分定义的，并通过NetLabel用户空间通信层进行配置。每个DOI定义可以有不同的安全属性映射表。

标签转换缓存
=======================

NetLabel系统提供了一个框架，用于缓存从网络标签到相应LSM标识符的安全属性映射。CIPSO/IPv4协议引擎支持这种缓存机制。
