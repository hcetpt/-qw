========================================
NetLabel Linux 安全模块接口
========================================

保罗·摩尔，paul.moore@hp.com

2006年5月17日

概述
=====

NetLabel 是一种可以从网络数据包中设置和检索安全属性的机制。它旨在供希望使用通用代码库来支持多种不同数据包标记协议的安全模块（LSM）开发者使用。NetLabel 安全模块 API 在 'include/net/netlabel.h' 中定义，下面将简要介绍。

NetLabel 安全属性
============================

由于 NetLabel 支持多种不同的数据包标记协议和 LSM，它使用了安全属性的概念来引用数据包的安全标签。NetLabel 安全属性由 NetLabel 头文件中的 'netlbl_lsm_secattr' 结构定义。内部地，NetLabel 子系统根据构建时间和运行时间配置将安全属性转换为正确的低级数据包标签。LSM 开发者需要将 NetLabel 安全属性转换为其特定 LSM 使用的安全标识符。

NetLabel LSM 协议操作
================================

这些函数允许 LSM 开发者操纵传出数据包上的标签以及读取传入数据包上的标签。这些函数既可以在套接字上操作，也可以直接在 sk_buff 上操作。这些高级函数会根据管理员对 NetLabel 子系统的配置被转换为低级协议操作。

NetLabel 标签映射缓存操作
=======================================

根据具体的配置，网络数据包标签与内部 LSM 安全标识符之间的转换可能会耗费大量时间。NetLabel 标签映射缓存是一种可以用来绕过大部分这种开销的缓存机制。一旦 LSM 收到一个数据包，并使用 NetLabel 解码其安全属性，并将这些安全属性转换为 LSM 内部标识符，LSM 可以使用 NetLabel 缓存函数将 LSM 内部标识符与网络数据包的标签关联起来。这意味着在未来，当传入的数据包匹配缓存值时，不仅可以绕过内部的 NetLabel 转换机制，还可以绕过 LSM 的转换机制，从而显著减少开销。
