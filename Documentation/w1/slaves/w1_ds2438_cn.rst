### 内核驱动程序 w1_ds2438
==================================

支持的芯片：

* Maxim DS2438 智能电池监控器

支持的家庭代码：
=================  =====
W1_FAMILY_DS2438       0x26
=================  =====

作者：Mariusz Bialonczyk <manio@skyboo.net>

描述
------

DS2438 芯片提供了多种在电池组中非常有用的特性。它还具有 40 字节的非易失性 EEPROM（电可擦除可编程只读存储器）。由于具备温度、电流和电压测量能力，该芯片也经常被用于气象站以及类似雨量计、风速/风向测量、湿度感应等应用中。
当前的支持是通过以下 sysfs 文件提供的（除了 "iad" 和 "offset" 外的所有文件都是只读的）：

"iad"
-----
此文件控制状态/配置寄存器中的“电流 A/D 控制位”（IAD）。
写入零值将清除 IAD 位并禁用电流测量。
写入值 "1" 将设置 IAD 位（启用测量）。
默认情况下，DS2438 中的 IAD 位处于启用状态。
当写入 sysfs 文件时，忽略第 2 到第 7 位，因此可以安全地写入 ASCII 字符。
当设置新值出现问题时返回 I/O 错误。

"page0"
-------
此文件提供芯片的完整 8 字节的第 0 页（00h）内容。
此页包含 DS2438 最常访问的信息。
"page1"
-------
此文件提供了芯片第1页（01h）的完整8字节数据。
这一页包含DS2438的ICA、已用时间计数器和电流偏移数据。
内部读取此文件时，也会从从设备获取额外的CRC字节。如果正确，8字节页面数据将传递给用户空间；否则，返回I/O错误。

"offset"
--------
此文件控制芯片的2字节偏移寄存器。
写入一个2字节值会改变偏移寄存器，进而改变芯片执行的电流测量。将该寄存器更改为当前寄存器的二进制补码并迫使负载中的电流为零，可以校准芯片，消除电流ADC中的偏移误差。

"temperature"
-------------
打开并读取此文件会触发芯片的CONVERT_T（温度转换）命令，之后从设备寄存器读取温度，并以ASCII十进制值提供。
重要：为了得到摄氏度的真实温度，需要将返回的值除以256。

"vad", "vdd"
------------
打开并读取此文件会触发芯片的CONVERT_V（电压转换）命令。
根据sysfs文件名的不同，A/D输入将选择不同的输入：

vad：
    通用A/D输入（VAD）
vdd：
    电池输入（VDD）

电压转换后，以十进制ASCII形式返回数值。
注意：要获得伏特值，必须将数值除以100。
