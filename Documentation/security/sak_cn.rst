=========================================
Linux 安全注意键 (SAK) 处理
=========================================

:日期: 2001年3月18日
:作者: Andrew Morton

操作系统的安全注意键（Secure Attention Key，简称SAK）是一种安全工具，用于防止特洛伊木马密码捕获程序。这是一种无法被击败的方法，可以杀死所有可能伪装成登录应用程序的程序。用户需要学会在登录系统之前输入这个键序列。

从PC键盘来看，Linux有两种类似但不同的方式来提供SAK。一种是ALT-SYSRQ-K序列。你不应该使用这个序列。只有当内核编译了sysrq支持时，它才可用。
正确生成SAK的方法是使用`loadkeys`定义键序列。这无论内核是否编译了sysrq支持都会生效。
SAK在键盘处于原始模式时工作正常。这意味着一旦定义好，SAK将终止正在运行的X服务器。如果系统处于运行级别5，X服务器将会重新启动。这就是你希望发生的情况。
你应该使用哪个键序列呢？嗯，CTRL-ALT-DEL用于重启机器。CTRL-ALT-BACKSPACE对X服务器来说有特殊作用。我们将选择CTRL-ALT-PAUSE。
在你的rc.sysinit（或rc.local）文件中添加如下命令：

```
echo "control alt keycode 101 = SAK" | /bin/loadkeys
```

就这样！只有超级用户可以重新编程SAK键。
.. note::

  1. 据说Linux SAK并不是“真正的SAK”，不符合实现C2级别安全系统的标准。作者不知道具体原因。
  2. 在PC键盘上，SAK会终止所有打开/dev/console的应用程序。
不幸的是，这包括了一些你实际上不想终止的东西。这是因为这些应用程序错误地保持/dev/console打开状态。一定要向你的Linux发行版投诉这个问题！

你可以用以下命令识别会被SAK终止的进程：

```
# ls -l /proc/[0-9]*/fd/* | grep console
l-wx------    1 root     root           64 Mar 18 00:46 /proc/579/fd/0 -> /dev/console
```

然后：

```
# ps aux|grep 579
root       579  0.0  0.1  1088  436 ?        S    00:43   0:00 gpm -t ps/2
```

因此`gpm`会被SAK终止。这是gpm的一个bug。它应该关闭标准输入。你可以通过找到启动gpm的初始化脚本并进行如下修改来解决这个问题：

旧版本：

```
daemon gpm
```

新版本：

```
daemon gpm < /dev/null
```

Vixie cron似乎也有这个问题，需要同样的处理。
另外，一个知名的Linux发行版在其rc.sysinit和rc脚本中有以下三行代码：

```
exec 3<&0
exec 4>&1
exec 5>&2
```

这些命令导致**所有**由初始化脚本启动的守护进程都有文件描述符3、4和5与/dev/console关联。因此，SAK会终止它们。解决方法是简单删除这些行，但这可能会导致系统管理应用程序出现故障——请全面测试一切。
当然，请提供你需要翻译的文本。
