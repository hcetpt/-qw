.. SPDX 许可证标识符: GPL-2.0

=========================
LPFC 驱动程序发布说明
=========================


.. 重要提示::

  从 8.0.17 版本开始，驱动程序严格针对上游内核。因此，我们移除了对较旧内核（早于 2.6.10）的 #ifdef。如果要在较旧内核上运行该驱动程序，则应使用 8.0.16 版本。
  对于 FC 远程端口和扩展属性支持的传输层修改现在已包含在 2.6.12 及更高版本的上游内核中。我们不再需要为此提供补丁，也不再需要提供一个同时支持新旧内核的完整版本。
  该驱动程序现在要求使用 2.6.12（如果使用预发布版，则为 2.6.12-rc1）或更新的内核。
  请留意这些依赖关系……
  下面提供的信息是为了在推动驱动程序被上游接受时提供更多背景资料。
  电缆拔除和临时设备丢失：

  在 lpfc 驱动程序的早期版本中，驱动程序内部会将从中层接收到的 I/O 操作排队。在电缆被拔除、链路抖动或设备因电缆移除、交换机重启或设备重启等原因暂时失去连接的情况下，驱动程序可以隐藏设备消失的情况。发送到 LLDD 的 I/O 操作会被短暂排队，允许设备重新出现或链路恢复，而不会对系统产生意外副作用。如果驱动程序不隐藏这些情况，I/O 操作会被驱动程序标记为错误，中层会耗尽重试次数，并且设备会被离线。需要手动干预才能重新启用设备。
  支持 kernel.org 的社区推动了一项努力，以移除所有 LLDD 中的内部排队。其理念是内部排队是不必要的，因为块层已经执行了排队。从 LLDD 移除队列会使 LLDD 更加可预测和简单。
  作为 kernel.org 的潜在新成员，8.x 版本的驱动程序被要求移除所有内部排队。Emulex 遵循了这一要求。
  在解释这一变化的影响时，Emulex 与社区合作，修改了 SCSI 中层的行为，以便在传输事件（如上述情况）发生时，SCSI 设备可以暂时挂起。

  提议的补丁已发布到 linux-scsi 邮件列表。该补丁包含在 2.6.10-rc2（及之后的版本）的补丁包中。因此，该补丁已成为标准 2.6.10 内核的一部分。
  默认情况下，驱动程序期望内核中包含用于阻塞/解阻塞接口的补丁。无需设置任何 #define 来启用支持。
### 内核支持

此源代码包仅针对上游内核。（请参阅此文件顶部的注释）。它依赖于正在逐渐迁移到 kernel.org 内核中的接口。

目前，该驱动程序需要 2.6.12（如果是预发布版本，则为 2.6.12-rc1）内核。
如果需要为旧版本内核使用驱动程序，请利用 8.0.16 版本的驱动源代码。

### 补丁

值得庆幸的是，目前不需要补丁。
