测试设备驱动程序中的挂起和恢复支持
====================================================

	(C) 2007 Rafael J. Wysocki <rjw@sisk.pl>，GPL

1. 准备测试系统
============================

不幸的是，要有效地测试驱动程序在整个系统挂起和恢复转换中的支持，必须在加载该驱动程序的情况下对一个完全功能的系统进行挂起和恢复。此外，应该多次进行这些操作，最好是连续多次，并且分别针对休眠（又称磁盘挂起或STD）和内存挂起（STR），因为每种情况涉及的操作略有不同，并且与机器BIOS的交互也有所不同。
当然，为了这个目的，测试系统必须能够在不加载被测试驱动程序的情况下正常挂起和恢复。因此，如果可能的话，在开始测试新驱动程序之前，应首先解决测试系统中所有与挂起/恢复相关的问题。有关调试挂起/恢复功能的更多信息，请参阅Documentation/power/basic-pm-debugging.rst。

2. 测试驱动程序
=====================

一旦您解决了测试系统在没有新驱动程序时的挂起/恢复相关问题，就可以开始测试了：

a) 将驱动程序构建为模块，加载它并尝试休眠的测试模式（详见：Documentation/power/basic-pm-debugging.rst，1）
b) 加载驱动程序并尝试以“重启”、“关机”和“平台”模式进行休眠（详见：Documentation/power/basic-pm-debugging.rst，1）
c) 将驱动程序直接编译到内核中并尝试休眠的测试模式
d) 使用直接编译到内核中的驱动程序尝试以“重启”、“关机”和“平台”模式进行休眠
e) 尝试内存挂起的测试模式（详见：Documentation/power/basic-pm-debugging.rst，2）。[就STR测试而言，无论驱动程序是否作为模块构建都无关紧要。]

f) 使用s2ram工具加载驱动程序后尝试内存挂起（详见：Documentation/power/basic-pm-debugging.rst，2）

上述每个测试都应该重复多次，并且应将STD测试与STR测试混合进行。如果任何测试失败，则不能认为该驱动程序是安全的挂起/恢复驱动程序。
