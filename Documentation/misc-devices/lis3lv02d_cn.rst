=======================
内核驱动程序 lis3lv02d
=======================

支持的芯片：

  * 意法半导体 LIS3LV02DL，LIS3LV02DQ（12位精度）
  * 意法半导体 LIS302DL，LIS3L02DQ，LIS331DL（8位）和 LIS331DLH（16位）

作者：
        - Yan Burman <burman.yan@gmail.com>
	- Eric Piel <eric.piel@tremplin-utc.net>

描述
-----------

此驱动程序为各种惠普笔记本电脑中使用的加速度计提供支持，这些笔记本具有官方称为“HP Mobile Data Protection System 3D”或“HP 3D DriveGuard”的功能。它会自动检测具有该传感器的笔记本电脑。已知的型号（完整列表可以在 drivers/platform/x86/hp_accel.c 中找到）将自动以标准方式定向其轴（例如：可以直接玩 neverball）。可以通过 /sys/devices/platform/lis3lv02d 访问加速度计数据。报告的值被缩放为 mg 值（地球重力的千分之一）。

/sys/devices/platform/lis3lv02d/ 下的 Sysfs 属性包括：

位置
      - 加速度计报告的3D位置。格式：“(x,y,z)”
采样率
      - 读取报告加速度计设备的采样率（HZ）
写入更改加速度计设备的采样率
仅接受硬件支持的值
自检
      - 根据芯片制造商的规范执行芯片自检
此驱动程序还提供了一个绝对输入类设备，允许笔记本电脑像弹球机一样的操纵杆工作。操纵杆设备可以进行校准。操纵杆设备可以有两种不同的模式
默认情况下，输出值在 -32768 到 32767 之间缩放。在原始模式下，操纵杆和 sysfs 位置条目的缩放相同。由于输入系统的模糊特性，可能存在细微差异
事件也可作为输入事件设备获得
自检仅用于硬件诊断目的，并不打算在正常操作期间使用。自检期间位置数据不会损坏，但中断行为不能保证可靠工作。在测试模式下，传感元件内部会稍微移动。自检测量正常模式与测试模式之间的差异。芯片规格指定了每种类型的芯片的可接受限制。通过平台数据提供这些限制，以便在不修改实际驱动程序的情况下调整限制
自检返回 “OK x y z” 或 “FAIL x y z”，其中 x、y 和 z 是两种模式之间的测量差异。自检模式下轴不会重新映射
### 提供测量值以帮助硬件诊断应用程序做出最终决定

在惠普笔记本电脑上，如果启用了 LED 基础设施，则会提供一个指示硬盘保护状态的 LED，路径为 `/sys/class/leds/hp::hddprotect`。

该驱动程序的另一个特性是名为“freefall”的杂项设备，其功能类似于 `/dev/rtc`，并且会对从设备接收到的自由落体中断作出反应。它支持阻塞操作、poll/select 模式以及 fasync 操作模式。您必须从设备读取 1 字节数据。结果是自上次成功读取以来的自由落体中断次数（如果中断次数超过范围则返回 255）。有关使用该设备的示例，请参阅 `freefall.c` 文件。

### 轴的方向

为了提高不同笔记本电脑之间的兼容性，加速度计报告的值被转换成一个“标准”轴布局（即“开箱即可玩 Neverball 游戏”）：

- 当笔记本电脑处于水平位置时，X 和 Y 的位置报告约为 0，Z 有一个正值。
- 如果左侧升高，X 增加（变为正数）。
- 如果前面（带有触摸板的一侧）升高，Y 减少（变为负数）。
- 如果将笔记本电脑倒置，Z 变为负数。

如果您的笔记本电脑型号未被识别（参见 `dmesg`），您可以向维护者发送邮件将其添加到数据库中。报告新笔记本电脑时，请附上 `dmidecode` 的输出以及在以下四种情况下的 `/sys/devices/platform/lis3lv02d/position` 的值。

### 问答

**问：如何安全地模拟自由落体？我有一台惠普“便携工作站”，重约 3.5 公斤，外壳是塑料的，所以让它掉在地上是不可能的。**

**答：** 传感器非常灵敏，用手就可以做到。把它抬到空中，在自由落体的过程中用手跟随大约 10 厘米的距离。这应该足以触发检测。
