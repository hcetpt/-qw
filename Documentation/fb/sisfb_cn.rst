什么是 sisfb？
=================

sisfb 是为 SiS（Silicon Integrated Systems）图形芯片设计的帧缓冲设备驱动程序。支持的型号包括：

- SiS 300 系列：SiS 300/305, 540, 630(S), 730(S)
- SiS 315 系列：SiS 315/H/PRO, 55x, (M)65x, 740, (M)661(F/M)X, (M)741(GX)
- SiS 330 系列：SiS 330 ("Xabre"), (M)760

为什么我需要一个帧缓冲驱动？
=================================

sisfb 在你需要高分辨率文本控制台时非常有用。除此之外，sisfb 还是运行 DirectFB 所必需的（DirectFB 针对 315 系列提供了一个额外的专用驱动）。在 300 系列上，对于内核版本低于 2.6.3 的情况，sisfb 在与 DRM/DRI 相关的功能中起着重要作用：sisfb 管理 DRM/DRI 用于 3D 纹理和其他数据的内存堆。这种内存管理对于使用 DRI/DRM 是必需的。
从大约 2.6.3 版本开始的内核不再需要 sisfb 来进行 DRI/DRM 内存管理。SiS DRM 驱动已经更新，并且具有自己的内存管理器（如果未编译 sisfb 则会使用它）。因此除非你需要图形控制台，否则在内核版本 >=2.6.3 的情况下不需要 sisfb。
附注：由于这是一个常见的错误：sisfb 和 vesafb 不能同时激活！请只在内核配置中选择其中之一。

如何向 sisfb 传递参数？
===================

这取决于具体情况：如果 sisfb 静态链接到内核中，请使用 lilo 的 append 声明将参数添加到内核命令行中。请参阅 lilo（或 GRUB）的文档以获取更多信息。如果 sisfb 是一个内核模块，则可以通过 modprobe（或 insmod）命令传递参数。
例如，当 sisfb 作为静态内核的一部分时，在 lilo.conf 中添加以下行：

```
append="video=sisfb:mode:1024x768x16,mem:12288,rate:75"
```

例如，当 sisfb 作为一个模块时，通过输入以下命令启动 sisfb：

```
modprobe sisfb mode=1024x768x16 rate=75 mem=12288
```

一个常见的错误是人们在使用静态编译到内核中的驱动程序时使用了错误的参数格式。请注意：如果 sisfb 编译到内核中，参数格式应为 `video=sisfb:mode:none` 或 `video=sisfb:mode:1024x768x16` （或您想要使用的任何模式，也可以使用上面描述的其他任何格式或 vesa 关键字代替 mode）。如果 sisfb 作为一个模块编译，参数格式为 `mode=none` 或 `mode=1024x768x16` （或您想要使用的任何模式）。使用“=”代替“:”（反之亦然）是一个很大的区别！
此外：如果您向内核中的 sisfb 提供多个参数，这些参数之间用 “,” 分隔。例如：

```
video=sisfb:mode:1024x768x16,rate:75,mem:12288
```

如何使用它？
================

前置声明：此文件仅涵盖了该驱动程序的部分功能和特性。更多信息请访问作者和维护者的网站 http://www.winischhofer.net/linuxsisvga.shtml。另外，“modinfo sisfb”提供了所有支持选项的概览，包括一些解释。
可以使用关键字“mode”并附加一个参数来指定所需的显示模式，参数格式如下：

  - XxYxDepth 或
  - XxY-Depth 或
  - XxY-Depth@Rate 或
  - XxY
  - 或者简单地使用十六进制或十进制表示的 VESA 模式编号
例如：1024x768x16, 1024x768-16@75, 1280x1024-16。如果没有指定深度，默认为 8。如果没有给出刷新率，默认为 60Hz。深度 32 表示 24 位颜色深度（但 32 位帧缓冲深度，这对用户来说无关紧要）。
此外，sisfb 还理解关键字“vesa”，后面跟着一个十进制或十六进制表示的 VESA 模式编号。例如：vesa=791 或 vesa=0x117。请使用“mode”或“vesa”之一，而不是两者都使用。
Linux 2.4 仅限：如果没有给定模式，如果 sisfb 作为一个模块编译，则默认为“无模式”（mode=none）；如果 sisfb 静态编译到内核中，则默认为 800x600x8，除非 CRT2 类型是 LCD，在这种情况下使用 LCD 的原生分辨率。如果您想切换到不同的模式，请使用 fbset 命令。
Linux 2.6 专用：如果没有指定模式，sisfb 默认为 800x600x8，除非 CRT2 类型是 LCD，在这种情况下它默认为 LCD 的本机分辨率。如果您想切换到其他模式，请使用 stty 命令。
您应该编译 vgacon（如果从系统中移除 SiS 卡时可以启动）和 sisfb（用于图形模式）。在 Linux 2.6 下，还需要“Framebuffer 控制台支持”(fbcon)，以获得图形控制台。
您不应该编译 vesafb。并且请不要在 lilo 或 grub 的配置文件中使用“vga=”关键字；模式选择应使用“mode”或“vesa”关键字作为参数。详见上下文。

X11
===
如果使用 XFree86 或 X.org，建议不要使用“fbdev”驱动程序，而是使用专门的“sis”X 驱动程序。“sis”X 驱动程序和 sisfb 由同一个人（Thomas Winischhofer）开发，并且彼此之间配合良好。

SVGALib
=======
如果直接访问硬件，SVGALib 通常无法正确恢复屏幕，尤其是在笔记本电脑上或输出设备为 LCD 或电视的情况下。因此，请在 SVGALib 配置中使用“FBDEV”芯片组。这将使 SVGALib 使用帧缓冲设备进行模式切换和恢复。

配置
=====
接受的选项（部分）：

=========  ==================================================================
off        禁用 sisfb。此选项仅在 sisfb 是内核内置而非模块时有效。
mem:X      控制台内存大小，其余部分将用于 DRI/DRM。X 的单位为千字节。对于 300 系列，默认值为 4096、8192 或 16384（每个值以千字节计），具体取决于显卡的视频内存大小。对于 315/330 系列，默认值为最大可用内存（因为这些芯片组不支持 DRI/DRM）。
noaccel    不使用 2D 加速引擎。（默认：使用加速）
noypan     禁用 y 方向平移和通过重绘整个屏幕进行滚动。这比 y 方向平移慢得多。（默认：使用 y 方向平移）
vesa:X     选择启动视频模式。X 的范围是从 0 到 0x1FF，代表 VESA 模式号（可以十进制或十六进制形式给出，后者前缀为“0x”）
模式:X    选择启动视频模式。有关“X”的格式，请参见上面的说明。
==================================

像"noaccel"或"noypan"这样的布尔选项，如果sisfb在内核中，则不需要参数（例如"video=sisfb:noypan"）。如果sisfb是一个模块，则需要将其设置为1（例如"modprobe sisfb noypan=1"）。

Thomas Winischhofer <thomas@winischhofer.net>

2004年5月27日
