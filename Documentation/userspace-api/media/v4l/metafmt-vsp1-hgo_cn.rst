``SPDX 许可证标识符: GFDL-1.1-no-invariants-or-later``

``v4l2-meta-fmt-vsp1-hgo``

``*******************************``
``V4L2_META_FMT_VSP1_HGO ('VSPH')``
``*******************************``

Renesas R-Car VSP1 一维直方图数据

描述
====

此格式描述了由 Renesas R-Car VSP1 一维直方图（HGO）引擎生成的直方图数据。VSP1 HGO 是一个可以处理 RGB、YCrCb 或 HSV 数据的直方图计算引擎。它可以在输入图像可能被裁剪和下采样的情况下工作，并计算所有像素的最小值、最大值和总和，以及每个通道的直方图。

HGO 可以独立地按每个通道计算直方图，也可以计算三个通道（仅限 RGB 数据）的最大值或仅计算 Y 通道（仅限 YCbCr）。它可以输出具有 64 或 256 个区间（bins）的直方图，从而导致四种可能的操作模式：

- 在 *64 个区间正常模式* 中，HGO 独立地在三个通道上操作，计算三个 64 区间的直方图。支持 RGB、YCbCr 和 HSV 图像格式。
- 在 *64 个区间最大值模式* 中，HGO 在 (R, G, B) 通道的最大值上操作，计算一个 64 区间的直方图。仅支持 RGB 图像格式。
- 在 *256 个区间正常模式* 中，HGO 在 Y 通道上操作，计算一个 256 区间的直方图。仅支持 YCbCr 图像格式。
- 在 *256 个区间最大值模式* 中，HGO 在 (R, G, B) 通道的最大值上操作，计算一个 256 区间的直方图。仅支持 RGB 图像格式。

字节顺序
=========
所有数据都以小端格式存储在内存中。表中的每个单元格包含一个字节。

.. flat-table:: VSP1 HGO 数据 - 64 区间，正常模式（792 字节）
    :header-rows:  2
    :stub-columns: 0

    * - 偏移量
      - :cspan:`4` 内存
    * -
      - [31:24]
      - [23:16]
      - [15:8]
      - [7:0]
    * - 0
      -
      - R/Cr/H 最大值 [7:0]
      -
      - R/Cr/H 最小值 [7:0]
    * - 4
      -
      - G/Y/S 最大值 [7:0]
      -
      - G/Y/S 最小值 [7:0]
    * - 8
      -
      - B/Cb/V 最大值 [7:0]
      -
      - B/Cb/V 最小值 [7:0]
    * - 12
      - :cspan:`4` R/Cr/H 总和 [31:0]
    * - 16
      - :cspan:`4` G/Y/S 总和 [31:0]
    * - 20
      - :cspan:`4` B/Cb/V 总和 [31:0]
    * - 24
      - :cspan:`4` R/Cr/H 第 0 区间 [31:0]
    * -
      - :cspan:`4` ...
* - 276
      - :cspan:`4` R/Cr/H 第 63 区间 [31:0]
    * - 280
      - :cspan:`4` G/Y/S 第 0 区间 [31:0]
    * -
      - :cspan:`4` ...
* - 532
      - :cspan:`4` G/Y/S bin 63 [31:0]
    * - 536
      - :cspan:`4` B/Cb/V bin 0 [31:0]
    * -
      - :cspan:`4` ..
* - 788
      - :cspan:`4` B/Cb/V bin 63 [31:0]

.. flat-table:: VSP1 HGO 数据 - 64 个 Bin，最大模式（264 字节）
    :header-rows:  2
    :stub-columns: 0

    * - 偏移量
      - :cspan:`4` 内存
    * -
      - [31:24]
      - [23:16]
      - [15:8]
      - [7:0]
    * - 0
      -
      - max(R,G,B) 最大值 [7:0]
      -
      - max(R,G,B) 最小值 [7:0]
    * - 4
      - :cspan:`4` max(R,G,B) 总和 [31:0]
    * - 8
      - :cspan:`4` max(R,G,B) bin 0 [31:0]
    * -
      - :cspan:`4` ..
* - 260
      - :cspan:`4` max(R,G,B) bin 63 [31:0]

.. flat-table:: VSP1 HGO 数据 - 256 个 Bin，普通模式（1032 字节）
    :header-rows:  2
    :stub-columns: 0

    * - 偏移量
      - :cspan:`4` 内存
    * -
      - [31:24]
      - [23:16]
      - [15:8]
      - [7:0]
    * - 0
      -
      - Y 最大值 [7:0]
      -
      - Y 最小值 [7:0]
    * - 4
      - :cspan:`4` Y 总和 [31:0]
    * - 8
      - :cspan:`4` Y bin 0 [31:0]
    * -
      - :cspan:`4` ..
* - 1028
      - :cspan:`4` Y bin 255 [31:0]

.. flat-table:: VSP1 HGO 数据 - 256 个 Bin，最大模式（1032 字节）
    :header-rows:  2
    :stub-columns: 0

    * - 偏移量
      - :cspan:`4` 内存
    * -
      - [31:24]
      - [23:16]
      - [15:8]
      - [7:0]
    * - 0
      -
      - max(R,G,B) 最大值 [7:0]
      -
      - max(R,G,B) 最小值 [7:0]
    * - 4
      - :cspan:`4` max(R,G,B) 总和 [31:0]
    * - 8
      - :cspan:`4` max(R,G,B) bin 0 [31:0]
    * -
      - :cspan:`4` ..
* - 1028
      - :cspan:`4` max(R,G,B) bin 255 [31:0]
