# SPDX-许可证标识符: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/devfreq/event/samsung,exynos-ppmu.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: Samsung Exynos SoC PPMU (平台性能监控单元)

维护者:
  - Chanwoo Choi <cw00.choi@samsung.com>
  - Krzysztof Kozlowski <krzk@kernel.org>

描述: |
  Samsung Exynos SoC 包含针对每个 IP 的 PPMU（平台性能监控单元）。PPMU 提供了获取性能数据的基础值。这些 PPMU 事件提供了有关 SoC 行为的信息，可以用来分析系统性能、使行为可视化以及统计各 IP（DMC、CPU、RIGHTBUS、LEFTBUS、CAM 接口、LCD、G3D、MFC）的使用情况。Exynos PPMU 驱动程序使用 devfreq-event 类来向各种 devfreq 设备提供事件数据。devfreq 设备在确定每个 IP 的当前状态时会使用这些事件数据。
属性:
  compatible:
    枚举:
      - samsung,exynos-ppmu
      - samsung,exynos-ppmu-v2

  clock-names:
    项:
      - 常量: ppmu

  clocks:
    最大项数: 1

  reg:
    最大项数: 1

  events:
    类型: 对象

    模式属性:
      '^ppmu-event[0-9]+(-[a-z0-9]+){,2}$':
        类型: 对象
        属性:
          event-name:
            描述: |
              在 PPMU 设备中的唯一事件名称
            $ref: /schemas/types.yaml#/definitions/string

          event-data-type:
            描述: |
              定义计数器将计数的数据类型
              可以检查 include/dt-bindings/pmu/exynos_ppmu.h 中的所有
              可能类型，例如计数读请求、按字节计数写入数据等。此字段是可选的，并且当它缺失时，驱动程序代码将使用默认数据类型
            $ref: /schemas/types.yaml#/definitions/uint32

        必需:
          - event-name

        不允许额外属性: false

    不允许额外属性: false

必需:
  - compatible
  - reg

不允许额外属性: false

示例:
  - |
    // Exynos3250 的 PPMUv1 节点（尽管板级 DTS 定义了事件）
    #include <dt-bindings/clock/exynos3250.h>

    ppmu_dmc0: ppmu@106a0000 {
        compatible = "samsung,exynos-ppmu";
        reg = <0x106a0000 0x2000>;

        events {
            ppmu_dmc0_3: ppmu-event3-dmc0 {
                event-name = "ppmu-event3-dmc0";
            };

            ppmu_dmc0_2: ppmu-event2-dmc0 {
                event-name = "ppmu-event2-dmc0";
            };

            ppmu_dmc0_1: ppmu-event1-dmc0 {
                event-name = "ppmu-event1-dmc0";
            };

            ppmu_dmc0_0: ppmu-event0-dmc0 {
                event-name = "ppmu-event0-dmc0";
            };
        };
    };

    ppmu_rightbus: ppmu@112a0000 {
        compatible = "samsung,exynos-ppmu";
        reg = <0x112a0000 0x2000>;
        clocks = <&cmu CLK_PPMURIGHT>;
        clock-names = "ppmu";

        events {
            ppmu_rightbus_3: ppmu-event3-rightbus {
                event-name = "ppmu-event3-rightbus";
            };
        };
    };

  - |
    // Exynos5433 中的 PPMUv2 节点
    ppmu_d0_cpu: ppmu@10480000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x10480000 0x2000>;
    };

    ppmu_d0_general: ppmu@10490000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x10490000 0x2000>;

        events {
            ppmu_event0_d0_general: ppmu-event0-d0-general {
                event-name = "ppmu-event0-d0-general";
            };
        };
    };

    ppmu_d0_rt: ppmu@104a0000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x104a0000 0x2000>;
    };

    ppmu_d1_cpu: ppmu@104b0000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x104b0000 0x2000>;
    };

    ppmu_d1_general: ppmu@104c0000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x104c0000 0x2000>;
    };

    ppmu_d1_rt: ppmu@104d0000 {
        compatible = "samsung,exynos-ppmu-v2";
        reg = <0x104d0000 0x2000>;
    };

  - |
    // Exynos4412 的带 event-data-type 的 PPMUv1 节点
    #include <dt-bindings/pmu/exynos_ppmu.h>

    ppmu@106a0000 {
        compatible = "samsung,exynos-ppmu";
        reg = <0x106a0000 0x2000>;
        clocks = <&clock 400>;
        clock-names = "ppmu";

        events {
            ppmu-event3-dmc0 {
                event-name = "ppmu-event3-dmc0";
                event-data-type = <(PPMU_RO_DATA_CNT |
                                    PPMU_WO_DATA_CNT)>;
            };
        };
    };
