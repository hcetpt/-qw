# SPDX-许可证标识符: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/allwinner,sun6i-a31-prcm.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: Allwinner A31 PRCM

维护者:
  - 陈宇蔡 <wens@csie.org>
  - 马克西姆·里帕德 <mripard@kernel.org>

废弃: true

属性:
  compatible:
    常量: allwinner,sun6i-a31-prcm

  reg:
    最大项目数: 1

模式属性:
  "^.*-(clk|rst)$":
    类型: 对象
    未评估属性: false

    属性:
      compatible:
        枚举:
          - allwinner,sun4i-a10-mod0-clk
          - allwinner,sun6i-a31-apb0-clk
          - allwinner,sun6i-a31-apb0-gates-clk
          - allwinner,sun6i-a31-ar100-clk
          - allwinner,sun6i-a31-clock-reset
          - 固定因子时钟

    必需:
      - compatible

    全部:
      - 如果:
          属性:
            compatible:
              包含:
                常量: 固定因子时钟

        那么:
          $ref: /schemas/clock/fixed-factor-clock.yaml#

      - 如果:
          属性:
            compatible:
              包含:
                常量: allwinner,sun4i-a10-mod0-clk

        那么:
          属性:
            "#clock-cells":
              常量: 0

            clocks:
              最大项目数: 2

            clock-output-names:
              最大项目数: 1

          必需:
            - "#clock-cells"
            - clocks
            - clock-output-names

      - 如果:
          属性:
            compatible:
              包含:
                常量: allwinner,sun6i-a31-apb0-clk

        那么:
          属性:
            "#clock-cells":
              常量: 0

            clocks:
              最大项目数: 1

            clock-output-names:
              最大项目数: 1

          必需:
            - "#clock-cells"
            - clocks
            - clock-output-names

      - 如果:
          属性:
            compatible:
              包含:
                常量: allwinner,sun6i-a31-apb0-gates-clk

        那么:
          属性:
            "#clock-cells":
              常量: 1
              描述: >
                传递给该时钟的这个额外参数是
                控制该特定门的位在寄存器中的偏移量
            clocks:
              最大项目数: 1

            clock-output-names:
              最小项目数: 1
              最大项目数: 32

          必需:
            - "#clock-cells"
            - clocks
            - clock-output-names

      - 如果:
          属性:
            compatible:
              包含:
                常量: allwinner,sun6i-a31-ar100-clk

        那么:
          属性:
            "#clock-cells":
              常量: 0

            clocks:
              最大项目数: 4
              描述: >
                父级顺序必须与硬件编程
                顺序匹配
            clock-output-names:
              最大项目数: 1

          必需:
            - "#clock-cells"
            - clocks
            - clock-output-names

      - 如果:
          属性:
            compatible:
              包含:
                常量: allwinner,sun6i-a31-clock-reset

        那么:
          属性:
            "#reset-cells":
              常量: 1

          必需:
            - "#reset-cells"

必需:
  - compatible
  - reg

附加属性: false

示例:
  - |
    #include <dt-bindings/clock/sun6i-a31-ccu.h>

    prcm@1f01400 {
        compatible = "allwinner,sun6i-a31-prcm";
        reg = <0x01f01400 0x200>;

        ar100: ar100-clk {
            compatible = "allwinner,sun6i-a31-ar100-clk";
            #clock-cells = <0>;
            clocks = <&rtc 0>, <&osc24M>,
                     <&ccu CLK_PLL_PERIPH>,
                     <&ccu CLK_PLL_PERIPH>;
            clock-output-names = "ar100";
        };

        ahb0: ahb0-clk {
            compatible = "fixed-factor-clock";
            #clock-cells = <0>;
            clock-div = <1>;
            clock-mult = <1>;
            clocks = <&ar100>;
            clock-output-names = "ahb0";
        };

        apb0: apb0-clk {
            compatible = "allwinner,sun6i-a31-apb0-clk";
            #clock-cells = <0>;
            clocks = <&ahb0>;
            clock-output-names = "apb0";
        };

        apb0_gates: apb0-gates-clk {
            compatible = "allwinner,sun6i-a31-apb0-gates-clk";
            #clock-cells = <1>;
            clocks = <&apb0>;
            clock-output-names = "apb0_pio", "apb0_ir",
                                 "apb0_timer", "apb0_p2wi",
                                 "apb0_uart", "apb0_1wire",
                                 "apb0_i2c";
        };

        ir_clk: ir-clk {
            #clock-cells = <0>;
            compatible = "allwinner,sun4i-a10-mod0-clk";
            clocks = <&rtc 0>, <&osc24M>;
            clock-output-names = "ir";
        };

        apb0_rst: apb0-rst {
            compatible = "allwinner,sun6i-a31-clock-reset";
            #reset-cells = <1>;
        };
    };
