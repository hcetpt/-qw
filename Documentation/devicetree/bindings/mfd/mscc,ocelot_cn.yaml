# SPDX-License-Identifier: GPL-2.0 OR BSD-2-Clause */
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/mscc,ocelot.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: Ocelot 外部控制的以太网交换机

维护者:
  - Colin Foster <colin.foster@in-advantage.com>

描述: |
  Ocelot 以太网交换机家族包含带有内部 CPU 的芯片 (VSC7513, VSC7514) 和不带内部 CPU 的芯片 (VSC7511, VSC7512)。所有交换机都有通过外部接口（如 SPI 或 PCIe）进行外部控制的选项。
  该交换机家族是一个多端口网络交换机，支持多种接口。此外，该设备可以执行引脚控制、MDIO 总线和外部 GPIO 扩展器的操作。

属性:
  compatible:
    枚举:
      - mscc,vsc7512

  reg:
    最大项数: 1

  "#address-cells":
    常量: 1

  "#size-cells":
    常量: 1

  spi-max-frequency:
    最大项数: 1

模式属性:
  "^pinctrl@[0-9a-f]+$":
    类型: 对象
    $ref: /schemas/pinctrl/mscc,ocelot-pinctrl.yaml

  "^gpio@[0-9a-f]+$":
    类型: 对象
    $ref: /schemas/pinctrl/microchip,sparx5-sgpio.yaml
    属性:
      compatible:
        枚举:
          - mscc,ocelot-sgpio

  "^mdio@[0-9a-f]+$":
    类型: 对象
    $ref: /schemas/net/mscc,miim.yaml
    属性:
      compatible:
        枚举:
          - mscc,ocelot-miim

  "^ethernet-switch@[0-9a-f]+$":
    类型: 对象
    $ref: /schemas/net/mscc,vsc7514-switch.yaml
    不评估属性: false
    属性:
      compatible:
        枚举:
          - mscc,vsc7512-switch

必需:
  - compatible
  - reg
  - '#address-cells'
  - '#size-cells'

额外属性: false

示例:
  - |
    ocelot_clock: ocelot-clock {
          compatible = "fixed-clock";
          #clock-cells = <0>;
          clock-frequency = <125000000>;
      };

    spi {
        #address-cells = <1>;
        #size-cells = <0>;

        soc@0 {
            compatible = "mscc,vsc7512";
            spi-max-frequency = <2500000>;
            reg = <0>;
            #address-cells = <1>;
            #size-cells = <1>;

            mdio@7107009c {
                compatible = "mscc,ocelot-miim";
                #address-cells = <1>;
                #size-cells = <0>;
                reg = <0x7107009c 0x24>;

                sw_phy0: ethernet-phy@0 {
                    reg = <0x0>;
                };
            };

            mdio@710700c0 {
                compatible = "mscc,ocelot-miim";
                pinctrl-names = "default";
                pinctrl-0 = <&miim1_pins>;
                #address-cells = <1>;
                #size-cells = <0>;
                reg = <0x710700c0 0x24>;

                sw_phy4: ethernet-phy@4 {
                    reg = <0x4>;
                };
            };

            gpio: pinctrl@71070034 {
                compatible = "mscc,ocelot-pinctrl";
                gpio-controller;
                #gpio-cells = <2>;
                gpio-ranges = <&gpio 0 0 22>;
                reg = <0x71070034 0x6c>;

                sgpio_pins: sgpio-pins {
                    pins = "GPIO_0", "GPIO_1", "GPIO_2", "GPIO_3";
                    function = "sg0";
                };

                miim1_pins: miim1-pins {
                    pins = "GPIO_14", "GPIO_15";
                    function = "miim";
                };
            };

            gpio@710700f8 {
                compatible = "mscc,ocelot-sgpio";
                #address-cells = <1>;
                #size-cells = <0>;
                bus-frequency = <12500000>;
                clocks = <&ocelot_clock>;
                microchip,sgpio-port-ranges = <0 15>;
                pinctrl-names = "default";
                pinctrl-0 = <&sgpio_pins>;
                reg = <0x710700f8 0x100>;

                sgpio_in0: gpio@0 {
                    compatible = "microchip,sparx5-sgpio-bank";
                    reg = <0>;
                    gpio-controller;
                    #gpio-cells = <3>;
                    ngpios = <64>;
                };

                sgpio_out1: gpio@1 {
                    compatible = "microchip,sparx5-sgpio-bank";
                    reg = <1>;
                    gpio-controller;
                    #gpio-cells = <3>;
                    ngpios = <64>;
                };
            };
        };
    };

..
