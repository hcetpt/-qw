# SPDX-许可证标识符: (GPL-2.0-only 或 BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/reset/gpio-poweroff.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: 通过 GPIO 控制的关机

维护者:
  - Sebastian Reichel <sre@kernel.org>

描述: >
  通过一个 GPIO 线来支持系统关机。当执行关机时，
  操作系统预期将 GPIO 从非激活状态切换到激活状态。
  经过一段时间延迟（active-delay-ms）后，它预期被切换回非激活状态。
  再经过另一段延迟时间（inactive-delay-ms）后，它被配置为激活状态。
  最后，如果系统在等待一段时间（timeout-ms）后仍然运行，则操作系统假定关机失败。
allOf:
  - $ref: restart-handler.yaml#

属性:
  compatible:
    常量: gpio-poweroff

  gpios:
    maxItems: 1

  input:
    类型: 布尔值
    描述: >
      初始时将 GPIO 线配置为输入。仅当启动关机序列时重新配置它为输出。
      如果此可选属性未指定，则 GPIO 初始化为其非激活状态下的输出。

  active-delay-ms:
    默认: 100
    描述: 在驱动 GPIO 激活后等待的延迟时间

  inactive-delay-ms:
    默认: 100
    描述: 在驱动 GPIO 非激活后等待的延迟时间

  priority:
    默认: 0

  timeout-ms:
    默认: 3000
    描述: 在假设关机序列失败前等待的时间
required:
  - compatible
  - gpios

additionalProperties: false

示例:
  - |
    gpio-poweroff {
        compatible = "gpio-poweroff";
        gpios = <&gpio 4 0>;
        timeout-ms = <3000>;
    };
