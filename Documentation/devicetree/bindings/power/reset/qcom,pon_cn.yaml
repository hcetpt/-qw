# SPDX-文件许可人: (GPL-2.0 或 BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/reset/qcom,pon.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: 高通 PON 设备

维护者:
  - Vinod Koul <vkoul@kernel.org>

描述: |
  对于高通 PM8xxx 的电源开启设备是一个支持 pwrkey
  和 resin 以及 Android 重启模式的多功功能设备 (MFD)
  此设备树节点有 pwrkey 和 resin 作为子节点
属性:
  compatible:
    枚举:
      - qcom,pm8916-pon
      - qcom,pm8941-pon
      - qcom,pms405-pon
      - qcom,pm8998-pon
      - qcom,pmk8350-pon

  reg:
    描述: |
      指定 PON (开机) 周边设备的 SPMI 基地址。对于
      拥有将 PON 周边设备 (GEN3) 分为 PON_HLOS 和 PON_PBS
      (例如 PMK8350) 的电源管理 IC，此属性可以包含
      两个 PON_HLOS 和 PON_PBS 周边设备的地址。在这种情况下，
      必须指定 PON_PBS 地址以便在某些电源管理 IC 上实现软件防抖动。
最小项数: 1
    最大项数: 2

  reg-names:
    最小项数: 1
    最大项数: 2

  pwrkey:
    类型: 对象
    $ref: /schemas/input/qcom,pm8941-pwrkey.yaml#

  resin:
    类型: 对象
    $ref: /schemas/input/qcom,pm8941-pwrkey.yaml#

  watchdog:
    类型: 对象
    $ref: /schemas/watchdog/qcom,pm8916-wdt.yaml

必需:
  - compatible
  - reg

未评估属性: false

allOf:
  - 如果:
      属性:
        compatible:
          包含:
            枚举:
              - qcom,pm8916-pon
              - qcom,pms405-pon
              - qcom,pm8998-pon
    然后:
      allOf:
        - $ref: reboot-mode.yaml#

      属性:
        reg:
          最大项数: 1
        reg-names:
          项:
            - 常量: pon

    # 特殊情况适用于 pm8941，它不存储重置模式
  - 如果:
      属性:
        compatible:
          包含:
            常量: qcom,pm8941-pon
    然后:
      属性:
        reg:
          最大项数: 1
        reg-names:
          项:
            - 常量: pon

  - 如果:
      属性:
        compatible:
          包含:
            常量: qcom,pmk8350-pon
    然后:
      属性:
        reg:
          最小项数: 1
          最大项数: 2
        reg-names:
          最小项数: 1
          项:
            - 常量: hlos
            - 常量: pbs

示例:
  - |
   #include <dt-bindings/interrupt-controller/irq.h>
   #include <dt-bindings/input/linux-event-codes.h>
   #include <dt-bindings/spmi/spmi.h>

   spmi@c440000 {
     reg = <0x0c440000 0x1100>;
     #address-cells = <2>;
     #size-cells = <0>;

     pmic@0 {
       reg = <0x0 SPMI_USID>;
       #address-cells = <1>;
       #size-cells = <0>;

       pon@800 {
         compatible = "qcom,pm8998-pon";
         reg = <0x800>;

         pwrkey {
            compatible = "qcom,pm8941-pwrkey";
            interrupts = <0x0 0x8 0 IRQ_TYPE_EDGE_BOTH>;
            debounce = <15625>;
            bias-pull-up;
            linux,code = <KEY_POWER>;
         };

         resin {
            compatible = "qcom,pm8941-resin";
            interrupts = <0x0 0x8 1 IRQ_TYPE_EDGE_BOTH>;
            debounce = <15625>;
            bias-pull-up;
            linux,code = <KEY_VOLUMEDOWN>;
         };
       };
     };
   };
..
