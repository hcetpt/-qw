# SPDX-许可证标识符: (GPL-2.0-only 或 BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/mediatek,power-controller.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: Mediatek电源域控制器

维护者:
  - MandyJH Liu <mandyjh.liu@mediatek.com>
  - Matthias Brugger <mbrugger@suse.com>

描述: |
  Mediatek处理器包括对多个电源域的支持，这些电源域能够根据不同的应用场景由软件进行上电/断电以节省电力。
  属于某个电源域的 IP 核应包含一个名为 'power-domains' 的属性，该属性是表示该域的 SCPSYS 节点的 phandle。
属性:
  $nodename:
    模式: '^power-controller(@[0-9a-f]+)?$'

  compatible:
    枚举:
      - mediatek,mt6795-power-controller
      - mediatek,mt8167-power-controller
      - mediatek,mt8173-power-controller
      - mediatek,mt8183-power-controller
      - mediatek,mt8186-power-controller
      - mediatek,mt8188-power-controller
      - mediatek,mt8192-power-controller
      - mediatek,mt8195-power-controller
      - mediatek,mt8365-power-controller

  '#power-domain-cells':
    常量: 1

  '#address-cells':
    常量: 1

  '#size-cells':
    常量: 0

模式属性:
  "^power-domain@[0-9a-f]+$":
    $ref: "#/$defs/power-domain-node"
    模式属性:
      "^power-domain@[0-9a-f]+$":
        $ref: "#/$defs/power-domain-node"
        模式属性:
          "^power-domain@[0-9a-f]+$":
            $ref: "#/$defs/power-domain-node"
            模式属性:
              "^power-domain@[0-9a-f]+$":
                $ref: "#/$defs/power-domain-node"
                未评估属性: false
            未评估属性: false
        未评估属性: false
    未评估属性: false

$defs:
  power-domain-node:
    类型: 对象
    描述: |
      表示在文档 `Documentation/devicetree/bindings/power/power-domain.yaml` 中定义的电源控制器节点内的电源域
属性:

      '#power-domain-cells':
        描述:
          对于表示单一 PM 域的节点，必须为 0；对于提供多个 PM 域的节点，必须为 1
'#address-cells':
        常量: 1

      '#size-cells':
        常量: 0

      reg:
        描述: |
          电源域索引。有效值定义在：
              "include/dt-bindings/power/mt6795-power.h" - 对于 MT8167 类型电源域
"include/dt-bindings/power/mt8167-power.h" - 对于 MT8167 类型电源域
"include/dt-bindings/power/mt8173-power.h" - 对于 MT8173 类型电源域
"include/dt-bindings/power/mt8183-power.h" - 对于 MT8183 类型电源域
"include/dt-bindings/power/mediatek,mt8188-power.h" - 对于 MT8188 类型电源域
"include/dt-bindings/power/mt8192-power.h" - 对于 MT8192 类型电源域
```plaintext
"include/dt-bindings/power/mt8195-power.h" - 适用于 MT8195 类型的电源域
"include/dt-bindings/power/mediatek,mt8365-power.h" - 适用于 MT8365 类型的电源域
最大项目数：1

      时钟：
        描述： |
          需要在电源域上电顺序中启用的时钟的 phandle 数量。
clock-names（时钟名称）:
        描述： |
          时钟名称列表，为了匹配每个电源域的上电顺序，我们需要按名称对时钟进行分组。BASIC 时钟需要在启用相应的电源域之前启用，并且其名称中不应包含 '-' （例如 mm、mfg、venc）；
SUSBYS 时钟需要在释放总线保护之前启用，并且其名称应包含 '-' （例如 mm-0、isp-0、cam-0）。
为了正确遵循上电顺序，必须按顺序指定时钟，首先添加 BASIC 时钟，然后是 SUSBSYS 时钟。
domain-supply（域供电）:
        描述：电源域调节器供电
mediatek,infracfg：
        $ref: /schemas/types.yaml#/definitions/phandle
        描述：包含 INFRACFG 寄存器范围的设备的 phandle。
mediatek,infracfg-nao：
        $ref: /schemas/types.yaml#/definitions/phandle
        描述：包含 INFRACFG-NAO 寄存器范围的设备的 phandle。
mediatek,smi：
        $ref: /schemas/types.yaml#/definitions/phandle
        描述：包含 SMI 寄存器范围的设备的 phandle。
```
以上是对给定内容的中文翻译。请注意，这里使用了“phandle”这个术语，它在上下文中指的是设备树中的一个指针，指向另一个节点。
这段文本是 Device Tree (设备树) 的描述，用于定义硬件平台的配置信息。以下是中文翻译：

```yaml
# 必需字段：
- reg

必需字段：
  - compatible

额外属性： false

示例：
  - |
    #include <dt-bindings/clock/mt8173-clk.h>
    #include <dt-bindings/power/mt8173-power.h>

    soc {  # 系统芯片（SoC）节点
        #address-cells = <2>;  # 地址单元数
        #size-cells = <2>;  # 大小单元数

        scpsys: syscon@10006000 {  # 系统控制节点
            compatible = "mediatek,mt8173-scpsys", "syscon", "simple-mfd";  # 兼容性声明
            reg = <0 0x10006000 0 0x1000>;  # 寄存器地址和大小

            spm: power-controller {  # 电源控制器节点
                compatible = "mediatek,mt8173-power-controller";  # 兼容性声明
                #address-cells = <1>;  # 地址单元数
                #size-cells = <0>;  # 大小单元数
                #power-domain-cells = <1>;  # 电源域单元数

                # 以下为该SoC的各个电源域
                power-domain@MT8173_POWER_DOMAIN_VDEC {  # VDEC 电源域
                    reg = <MT8173_POWER_DOMAIN_VDEC>;  # 电源域标识符
                    clocks = <&topckgen CLK_TOP_MM_SEL>;  # 需要的时钟
                    clock-names = "mm";  # 时钟名称
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_VENC {  # VENC 电源域
                    reg = <MT8173_POWER_DOMAIN_VENC>;  # 电源域标识符
                    clocks = <&topckgen CLK_TOP_MM_SEL>, <&topckgen CLK_TOP_VENC_SEL>;  # 需要的时钟
                    clock-names = "mm", "venc";  # 时钟名称
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_ISP {  # ISP 电源域
                    reg = <MT8173_POWER_DOMAIN_ISP>;  # 电源域标识符
                    clocks = <&topckgen CLK_TOP_MM_SEL>;  # 需要的时钟
                    clock-names = "mm";  # 时钟名称
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_MM {  # MM 电源域
                    reg = <MT8173_POWER_DOMAIN_MM>;  # 电源域标识符
                    clocks = <&topckgen CLK_TOP_MM_SEL>;  # 需要的时钟
                    clock-names = "mm";  # 时钟名称
                    #power-domain-cells = <0>;  # 电源域单元数
                    mediatek,infracfg = <&infracfg>;  # 特定于MediaTek的配置
                };
                power-domain@MT8173_POWER_DOMAIN_VENC_LT {  # VENC_LT 电源域
                    reg = <MT8173_POWER_DOMAIN_VENC_LT>;  # 电源域标识符
                    clocks = <&topckgen CLK_TOP_MM_SEL>, <&topckgen CLK_TOP_VENC_LT_SEL>;  # 需要的时钟
                    clock-names = "mm", "venclt";  # 时钟名称
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_AUDIO {  # AUDIO 电源域
                    reg = <MT8173_POWER_DOMAIN_AUDIO>;  # 电源域标识符
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_USB {  # USB 电源域
                    reg = <MT8173_POWER_DOMAIN_USB>;  # 电源域标识符
                    #power-domain-cells = <0>;  # 电源域单元数
                };
                power-domain@MT8173_POWER_DOMAIN_MFG_ASYNC {  # MFG_ASYNC 电源域
                    reg = <MT8173_POWER_DOMAIN_MFG_ASYNC>;  # 电源域标识符
                    clocks = <&clk26m>;  # 需要的时钟
                    clock-names = "mfg";  # 时钟名称
                    #address-cells = <1>;  # 地址单元数
                    #size-cells = <0>;  # 大小单元数
                    #power-domain-cells = <1>;  # 电源域单元数

                    power-domain@MT8173_POWER_DOMAIN_MFG_2D {  # MFG_2D 电源域
                        reg = <MT8173_POWER_DOMAIN_MFG_2D>;  # 电源域标识符
                        #address-cells = <1>;  # 地址单元数
                        #size-cells = <0>;  # 大小单元数
                        #power-domain-cells = <1>;  # 电源域单元数

                        power-domain@MT8173_POWER_DOMAIN_MFG {  # MFG 电源域
                            reg = <MT8173_POWER_DOMAIN_MFG>;  # 电源域标识符
                            #power-domain-cells = <0>;  # 电源域单元数
                            mediatek,infracfg = <&infracfg>;  # 特定于MediaTek的配置
                        };
                    };
                };
            };
        };
    };
```
请注意，由于设备树语法的特殊性，这里的中文翻译保持了原有的语法结构，并尽可能地保留了原文中的关键字和符号。
