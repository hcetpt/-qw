# SPDX-许可证标识符: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/supply/qcom,pm8941-charger.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: 高通开关模式电池充电器和升压

maintainers:
  - Sebastian Reichel <sre@kernel.org>

properties:
  compatible:
    enum:
      - qcom,pm8226-charger
      - qcom,pm8941-charger

  reg:
    maxItems: 1

  interrupts:
    items:
      - description: 充电完成
      - description: 快速充电模式
      - description: 滴流充电模式
      - description: 电池温度正常
      - description: 电池存在
      - description: 充电器断开
      - description: USB输入有效
      - description: DC输入有效

  interrupt-names:
    items:
      - const: chg-done
      - const: chg-fast
      - const: chg-trkl
      - const: bat-temp-ok
      - const: bat-present
      - const: chg-gone
      - const: usb-valid
      - const: dc-valid

  qcom,fast-charge-current-limit:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 100000
    maximum: 3000000
    description: 最大充电电流（微安）；可能会受到安全限制；默认为1A

  qcom,fast-charge-low-threshold-voltage:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 2100000
    maximum: 3600000
    description: |
      电池电压限制（微伏），在此电压之上可进行快速充电；默认为3.2V
      在此电压以下将自动进行线性或开关模式滴流充电

  qcom,fast-charge-high-threshold-voltage:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 3240000
    maximum: 5000000
    description: |
      电池电压限制（微伏），在此电压之下可进行快速充电；默认为4.2V
      快速充电器将尝试将电池充电至该电压；可能会受到安全限制

  qcom,fast-charge-safe-voltage:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 3240000
    maximum: 5000000
    description: |
      最大安全电池电压（微伏）；可能由引导加载程序预设，在这种情况下，
      设置此值将无害地失败。属性“fast-charge-high-watermark”将被此值限制。默认为4.2V

  qcom,fast-charge-safe-current:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 100000
    maximum: 3000000
    description: |
      最大安全电池充电电流（微安）；可能由引导加载程序预设，在这种情况下，
      设置此值将无害地失败。属性“qcom,fast-charge-current-limit”将被此值限制。默认为1A

  qcom,auto-recharge-threshold-voltage:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 3240000
    maximum: 5000000
    description: |
      电池电压限制（微伏），低于此电压时，自动再充电功能将在充电结束之后重新开始充电；
      自动再充电的高截止限制为此值的5%以上。默认为4.1V

  qcom,minimum-input-voltage:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 4200000
    maximum: 9600000
    description: |
      输入电压水平（微伏），高于此电压时，充电操作可以进行。默认为4.3V

  qcom,dc-current-limit:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 100000
    maximum: 2500000
    description: |
      默认DC充电电流限制（微安）。默认为100mA

  qcom,disable-dc:
    type: boolean
    description: 禁用DC充电器

  qcom,jeita-extended-temp-range:
    type: boolean
    description: |
      启用JEITA扩展温度范围；这*不会*调整在扩展温度范围内的最大充电
      电压或电流。它只允许在电池处于扩展温度范围内进行充电。如果设置了此标志，
      为了完全符合JEITA安全指南，必须外部调节电压/电流。
The provided text describes a Device Tree (DT) fragment that configures a Power Management IC (PMIC) component, specifically focusing on its charger and USB On-The-Go (OTG) capabilities. Here's a translation into Chinese:

`usb-charge-current-limit`:
    `$ref`: /schemas/types.yaml#/definitions/uint32
    最小值: 100000
    最大值: 2500000
    描述: 默认的USB充电电流限制（以微安为单位）

`usb-otg-in-supply`:
    描述: 指向为USB_OTG_IN引脚供电的稳压器的引用

`otg-vbus`:
    `$ref`: /schemas/regulator/regulator.yaml#
    描述: 
      此节点定义了一个用于控制VBUS电压方向的稳压器。
      特别地，是指定是否为OTG端口的主机模式操作向VBUS提供电压，
      或者允许从外部VBUS输入电压进行充电。在硬件中，该稳压器的电源来自`usb-otg-in-supply`

必需字段:
  - `compatible`
  - `reg`
  - `interrupts`
  - `interrupt-names`

不允许额外属性。

示例:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    pmic {
      #address-cells = <1>;
      #size-cells = <0>;

      charger@1000 {
        compatible = "qcom,pm8941-charger";
        reg = <0x1000>;
        interrupts = <0x0 0x10 7 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x10 5 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x10 4 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x12 1 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x12 0 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x13 2 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x13 1 IRQ_TYPE_EDGE_BOTH>,
                     <0x0 0x14 1 IRQ_TYPE_EDGE_BOTH>;
        interrupt-names = "chg-done",
                          "chg-fast",
                          "chg-trkl",
                          "bat-temp-ok",
                          "bat-present",
                          "chg-gone",
                          "usb-valid",
                          "dc-valid";
        qcom,fast-charge-current-limit = <1000000>;
        qcom,dc-current-limit = <1000000>;
        usb-otg-in-supply = <&pm8941_5vs1>;

        otg-vbus {};
      };
    };

这个示例配置了一个PMIC组件，包括一个充电器和与USB OTG相关的配置。它定义了充电器的兼容性、寄存器地址、中断以及一些特定的属性，例如快速充电电流限制和DC电流限制。此外，还指定了USB OTG输入的电源供应和用于控制VBUS电压方向的节点。
