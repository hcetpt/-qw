# SPDX-许可证标识符: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/supply/maxim,max17040.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Maxim 17040 燃料表系列

maintainers:
  - Sebastian Reichel <sre@kernel.org>

allOf:
  - $ref: power-supply.yaml#

properties:
  compatible:
    enum:
      - maxim,max17040
      - maxim,max17041
      - maxim,max17043
      - maxim,max17044
      - maxim,max17048
      - maxim,max17049
      - maxim,max17058
      - maxim,max17059
      - maxim,max77836-battery

  reg:
    maxItems: 1

  maxim,alert-low-soc-level:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 1
    maximum: 32
    description: |
      设置产生中断的荷电状态（%）阈值。如果省略，则使用上电默认值 4（%）。
maxim,double-soc:
    类型: 布尔
    description: |
      某些设备返回的容量是实际的两倍。
      指定此属性以将报告的值除以 2，从而使其标准化。
      SoC == 荷电状态 == 容量
maxim,rcomp:
    $ref: /schemas/types.yaml#/definitions/uint8-array
    minItems: 1
    maxItems: 2
    description: |
      用于补偿不同电池化学成分和工作温度下的读数的值。
      max17040,41 的 rcomp 为两个字节，默认值为 0x97 0x00。
      所有其他设备的 rcomp 为一个字节，默认值为 0x97。
interrupts:
    maxItems: 1

  io-channels:
    items:
      - description: 电池温度

  io-channel-names:
    items:
      - const: temp

  wakeup-source:
    类型: 布尔
    description: |
      使用此属性将低荷电状态报警中断作为唤醒源。
required:
  - compatible
  - reg

unevaluatedProperties: false

examples:
  - |
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;

      battery@36 {
        compatible = "maxim,max17048";
        reg = <0x36>;
        maxim,rcomp = /bits/ 8 <0x56>;
        maxim,alert-low-soc-level = <10>;
        maxim,double-soc;
      };
    };
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;

      battery@36 {
        compatible = "maxim,max77836-battery";
        reg = <0x36>;
        maxim,alert-low-soc-level = <10>;
        interrupt-parent = <&gpio7>;
        interrupts = <2 IRQ_TYPE_LEVEL_LOW>;
        wakeup-source;
      };
    };
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;

      fuel-gauge@36 {
        compatible = "maxim,max17043";
        reg = <0x36>;

        interrupt-parent = <&gpio>;
        interrupts = <144 IRQ_TYPE_EDGE_FALLING>;

        monitored-battery = <&battery>;
        power-supplies = <&charger>;

        io-channels = <&adc 8>;
        io-channel-names = "temp";

        maxim,alert-low-soc-level = <10>;
        wakeup-source;
      };
    };
