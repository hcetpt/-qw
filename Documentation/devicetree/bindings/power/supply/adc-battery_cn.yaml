# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/power/supply/adc-battery.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: ADC 电池

maintainers:
  - Sebastian Reichel <sre@kernel.org>

description:
  基本的电池容量计，仅通过 ADC 通道报告基本的电池数据，并可选地通过轮询 GPIO 线指示电池已充满
电压预期在电池端子间测量，这是必须的。可选的电流/功率通道预期监测从电池流出的电流/功率。最后，温度通道预期测量电池温度
allOf:
  - $ref: power-supply.yaml#

properties:
  compatible:
    const: adc-battery

  charged-gpios:
    description:
      表示电池已完全充电的 GPIO。该 GPIO 通常由软件不可控的充电 IC 提供
maxItems: 1

  io-channels:
    minItems: 1
    maxItems: 4

  io-channel-names:
    minItems: 1
    items:
      - const: voltage
      - enum: [ current, power, temperature ]
      - enum: [ power, temperature ]
      - const: temperature

  monitored-battery: true

required:
  - compatible
  - io-channels
  - io-channel-names
  - monitored-battery

unevaluatedProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>

    fuel-gauge {
        compatible = "adc-battery";
        charged-gpios = <&gpio 42 GPIO_ACTIVE_HIGH>;
        io-channels = <&adc 13>, <&adc 37>;
        io-channel-names = "voltage", "current";

        power-supplies = <&charger>;
        monitored-battery = <&battery>;
    };
