# SPDX-文件许可人: (GPL-2.0-only 或 BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/leds/richtek,rt8515.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Richtek RT8515 1.5A 双通道 LED 驱动器

maintainers:
  - Linus Walleij <linus.walleij@linaro.org>

description: |
  Richtek RT8515 是一款双通道（两种模式）的 LED 驱动器，支持驱动白色 LED 在闪光或手电筒模式下工作。每个模式的最大电流由硬件中的两个电阻 RFS 和 RTS 定义。
properties:
  compatible:
    const: richtek,rt8515

  enf-gpios:
    maxItems: 1
    description: 连接到“ENF”（启用闪光）引脚的连接
  ent-gpios:
    maxItems: 1
    description: 连接到“ENT”（启用手电筒）引脚的连接
  richtek,rfs-ohms:
    minimum: 7680
    maximum: 367000
    description: RFS 电阻的阻值。该电阻限制了最大闪光电流。此属性必须设置以使 flash-max-microamp 属性生效，RFS 电阻定义了闪光 LED 的调光设置（亮度）范围
  richtek,rts-ohms:
    minimum: 7680
    maximum: 367000
    description: RTS 电阻的阻值。该电阻限制了最大手电筒电流。此属性必须设置以使 torch-max-microamp 属性生效，RTS 电阻定义了手电筒 LED 的调光设置（亮度）范围
  led:
    type: object
    $ref: common.yaml#
    properties:
      function: true
      color: true
      flash-max-timeout-us: true

      flash-max-microamp:
        maximum: 700000
        description: 闪光模式下的最大电流是通过将 RFS 电阻接地硬连线到组件中。最大硬件电流设置根据公式 Imax = 5500 / RFS 计算。允许的最低电阻值为 7.86 kOhm，给出绝对最大电流为 700mA。通过在设备树中设置此属性，您可以进一步限制最大电流低于硬件限制。这需要定义 RFS，因为它定义了最大范围
      led-max-microamp:
        maximum: 700000
        description: 手电筒模式下的最大电流是通过将 RTS 电阻接地硬连线到组件中。最大硬件电流设置根据公式 Imax = 5500 / RTS 计算。允许的最低电阻值为 7.86 kOhm，给出绝对最大电流为 700mA。通过在设备树中设置此属性，您可以进一步限制最大电流低于硬件限制。这需要定义 RTS，因为它定义了最大范围
additionalProperties: false

required:
  - compatible
  - ent-gpios
  - enf-gpios
  - led

additionalProperties: false

examples:
  - |
    #include <dt-bindings/gpio/gpio.h>
    #include <dt-bindings/leds/common.h>

    led-controller {
        compatible = "richtek,rt8515";
        enf-gpios = <&gpio4 12 GPIO_ACTIVE_HIGH>;
        ent-gpios = <&gpio4 13 GPIO_ACTIVE_HIGH>;
        richtek,rfs-ohms = <16000>;
        richtek,rts-ohms = <100000>;

        led {
            function = LED_FUNCTION_FLASH;
            color = <LED_COLOR_ID_WHITE>;
            flash-max-timeout-us = <250000>;
            flash-max-microamp = <150000>;
            led-max-microamp = <25000>;
        };
    };
