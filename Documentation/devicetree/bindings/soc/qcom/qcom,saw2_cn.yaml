### 许可证标识符: (GPL-2.0 或 BSD-2-Clause)
%%YAML 1.2
---
$id: http://devicetree.org/schemas/soc/qcom/qcom,saw2.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: 高通子系统电源管理器 / SPM AVS 包装器 2 (SAW2)

maintainers:
  - Andy Gross <agross@kernel.org>
  - Bjorn Andersson <bjorn.andersson@linaro.org>

description: |
  高通子系统电源管理器用于控制高通平台中应用核心周围的外围逻辑。
  SAW2是围绕子系统电源管理器（SPM）和自适应电压缩放（AVS）硬件的包装器。SPM是一个可编程电源控制器，它通过直接连接到PMIC将硬件（如处理器或子系统）转换为低功耗模式并从中退出。它还可以与其他系统中的处理器相连，在进入或退出低功耗状态时通知它们。

properties:
  compatible:
    items:
      - enum:
          - qcom,ipq4019-saw2-cpu
          - qcom,ipq4019-saw2-l2
          - qcom,ipq8064-saw2-cpu
          - qcom,sdm660-gold-saw2-v4.1-l2
          - qcom,sdm660-silver-saw2-v4.1-l2
          - qcom,msm8998-gold-saw2-v4.1-l2
          - qcom,msm8998-silver-saw2-v4.1-l2
          - qcom,msm8909-saw2-v3.0-cpu
          - qcom,msm8916-saw2-v3.0-cpu
          - qcom,msm8939-saw2-v3.0-cpu
          - qcom,msm8226-saw2-v2.1-cpu
          - qcom,msm8226-saw2-v2.1-l2
          - qcom,msm8960-saw2-cpu
          - qcom,msm8974-saw2-v2.1-cpu
          - qcom,msm8974-saw2-v2.1-l2
          - qcom,msm8976-gold-saw2-v2.3-l2
          - qcom,msm8976-silver-saw2-v2.3-l2
          - qcom,apq8084-saw2-v2.1-cpu
          - qcom,apq8084-saw2-v2.1-l2
          - qcom,apq8064-saw2-v1.1-cpu
      - const: qcom,saw2

  reg:
    items:
      - description: SPM寄存器区域的基本地址和大小
      - description: 别名寄存器区域的基本地址和大小
    minItems: 1

  regulator:
    $ref: /schemas/regulator/regulator.yaml#
    description: 表示此SPM设备作为其所属核心（CPU或缓存）的调节设备
      设备工作

required:
  - compatible
  - reg

additionalProperties: false

examples:
  - |

    /* 示例 1: 使用SAW2和kpss-acc-v2 CPU空闲的SoC */
    cpus {
        #address-cells = <1>;
        #size-cells = <0>;

        cpu@0 {
            compatible = "qcom,kryo";
            device_type = "cpu";
            enable-method = "qcom,kpss-acc-v2";
            qcom,saw = <&saw0>;
            reg = <0x0>;
            operating-points-v2 = <&cpu_opp_table>;
        };
    };

    saw0: power-manager@f9089000 {
        compatible = "qcom,msm8974-saw2-v2.1-cpu", "qcom,saw2";
        reg = <0xf9089000 0x1000>;
    };

  - |

    /*
     * 示例 2: 新一代多集群SoC仅使用SAW用于L2；
     * 这不需要任何cpuidle驱动程序，也不需要任何cpu phandle
*/
    power-manager@17812000 {
        compatible = "qcom,msm8998-gold-saw2-v4.1-l2", "qcom,saw2";
        reg = <0x17812000 0x1000>;
    };

    power-manager@17912000 {
        compatible = "qcom,msm8998-silver-saw2-v4.1-l2", "qcom,saw2";
        reg = <0x17912000 0x1000>;
    };

  - |
    /*
     * 示例 3: 带有捆绑调节器定义的SAW2
*/
    power-manager@2089000 {
        compatible = "qcom,apq8064-saw2-v1.1-cpu", "qcom,saw2";
        reg = <0x02089000 0x1000>, <0x02009000 0x1000>;

        regulator {
            regulator-min-microvolt = <850000>;
            regulator-max-microvolt = <1300000>;
        };
    };
