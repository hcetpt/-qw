# SPDX-许可证标识符: (GPL-2.0)
# 版权所有 2020 Linaro 有限公司
%YAML 1.2
---
$id: http://devicetree.org/schemas/thermal/thermal-cooling-devices.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

标题: 热冷却设备

维护者:
  - Amit Kucheria <amitk@kernel.org>

描述: |
  设备树中的热管理是通过描述传感器硬件、以及为采取适当行动以缓解热过载所需的冷却设备和热区域的软件抽象来实现的。
  以下节点类型用于在设备树中完全描述一个热管理系统：
   - 热传感器: 测量温度的设备，具有特定于SoC的绑定
   - 冷却设备: 用于被动或主动散热的设备
   - 热区域: 包含以下节点类型的容器，用于描述平台的所有热数据

  此绑定描述了冷却设备
存在两种基本方式来提供功率耗散的控制：
    - 被动冷却: 通过调节设备性能。一个典型的被动冷却机制是一个具有动态电压和频率缩放（DVFS）的CPU，并使用较低的频率作为冷却状态
    - 主动冷却: 通过激活设备来移除散发的热量，例如，调节风扇速度
任何冷却设备都有一系列冷却状态（即不同的热量散发级别）。它们还有一种确定设备当前冷却状态的方法。例如，风扇的冷却状态对应于可能的不同风扇速度。冷却状态用单个无符号整数表示，其中较大的数字意味着更大的热量散发。与设备相关联的确切冷却状态集应在特定设备的绑定中定义
选择: true

属性:
  "#cooling-cells":
    描述:
      必须为2，以便指定在冷却映射参考中使用的最小和最大冷却状态。第一个单元是最小冷却状态，第二个单元是请求的最大冷却状态
常量: 2

额外属性: true

示例:
  - |
    #include <dt-bindings/interrupt-controller/arm-gic.h>
    #include <dt-bindings/thermal/thermal.h>

    // 示例 1: CPU0 上的 Cpufreq 冷却设备
    cpus {
            #address-cells = <2>;
            #size-cells = <0>;

            CPU0: cpu@0 {
                    device_type = "cpu";
                    compatible = "qcom,kryo385";
                    reg = <0x0 0x0>;
                    enable-method = "psci";
                    cpu-idle-states = <&LITTLE_CPU_SLEEP_0>,
                                      <&LITTLE_CPU_SLEEP_1>,
                                      <&CLUSTER_SLEEP_0>;
                    capacity-dmips-mhz = <607>;
                    dynamic-power-coefficient = <100>;
                    qcom,freq-domain = <&cpufreq_hw 0>;
                    #cooling-cells = <2>;
                    next-level-cache = <&L2_0>;
                    L2_0: l2-cache {
                            compatible = "cache";
                            cache-unified;
                            cache-level = <2>;
                            next-level-cache = <&L3_0>;
                            L3_0: l3-cache {
                                    compatible = "cache";
                                    cache-unified;
                                    cache-level = <3>;
                            };
                    };
          };

          /* ... */

    };

    /* ... */

    thermal-zones {
            cpu0-thermal {
                    polling-delay-passive = <250>;
                    polling-delay = <1000>;

                    thermal-sensors = <&tsens0 1>;

                    trips {
                            cpu0_alert0: trip-point0 {
                                    temperature = <90000>;
                                    hysteresis = <2000>;
                                    type = "passive";
                            };
                    };

                    cooling-maps {
                            map0 {
                                    trip = <&cpu0_alert0>;
                                    /* 对应 OPP 表中的 1000MHz */
                                    cooling-device = <&CPU0 5 5>;
                            };
                    };
            };

            /* ... */
    };
..
