程序类型和ELF段
==============================

下表列出了程序类型、相关联的附加类型以及libbpf为它们支持的ELF段名称。ELF段名称遵循以下规则：

- `type` 是精确匹配，例如 `SEC("socket")`
- `type+` 意味着它可以是精确的 `SEC("type")` 或者格式良好的 `SEC("type/extras")`，其中 `type` 和 `extras` 之间用 `'/'` 分隔
当指定了 `extras` 时，它们提供了如何自动附加BPF程序的细节。`extras` 的格式取决于程序类型，例如对于tracepoint为 `SEC("tracepoint/<category>/<name>")` 或者对于USDT探针为 `SEC("usdt/<path>:<provider>:<name>")`。脚注中对 `extras` 进行了更详细的描述。

+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| 程序类型                                  | 附加类型                            | ELF段名称                         | 可睡眠     |
+===========================================+========================================+==================================+===========+
| `BPF_PROG_TYPE_CGROUP_DEVICE`            | `BPF_CGROUP_DEVICE`                  | `cgroup/dev`                     |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_CGROUP_SKB`               |                                        | `cgroup/skb`                     |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET_EGRESS`             | `cgroup_skb/egress`              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET_INGRESS`            | `cgroup_skb/ingress`             |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_CGROUP_SOCKOPT`           | `BPF_CGROUP_GETSOCKOPT`              | `cgroup/getsockopt`              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_SETSOCKOPT`              | `cgroup/setsockopt`              |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_CGROUP_SOCK_ADDR`         | `BPF_CGROUP_INET4_BIND`              | `cgroup/bind4`                   |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET4_CONNECT`           | `cgroup/connect4`                |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET4_GETPEERNAME`       | `cgroup/getpeername4`            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET4_GETSOCKNAME`       | `cgroup/getsockname4`            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET6_BIND`              | `cgroup/bind6`                   |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET6_CONNECT`           | `cgroup/connect6`                |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET6_GETPEERNAME`       | `cgroup/getpeername6`            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET6_GETSOCKNAME`       | `cgroup/getsockname6`            |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UDP4_RECVMSG`            | `cgroup/recvmsg4`                |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UDP4_SENDMSG`            | `cgroup/sendmsg4`                |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UDP6_RECVMSG`            | `cgroup/recvmsg6`                |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UDP6_SENDMSG`            | `cgroup/sendmsg6`                |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UNIX_CONNECT`            | `cgroup/connect_unix`            |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UNIX_SENDMSG`            | `cgroup/sendmsg_unix`            |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UNIX_RECVMSG`            | `cgroup/recvmsg_unix`            |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UNIX_GETPEERNAME`        | `cgroup/getpeername_unix`        |           |
|                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_UNIX_GETSOCKNAME`        | `cgroup/getsockname_unix`        |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_CGROUP_SOCK`              | `BPF_CGROUP_INET4_POST_BIND`         | `cgroup/post_bind4`              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET6_POST_BIND`         | `cgroup/post_bind6`              |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET_SOCK_CREATE`        | `cgroup/sock_create`             |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `cgroup/sock`                    |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_CGROUP_INET_SOCK_RELEASE`       | `cgroup/sock_release`            |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_CGROUP_SYSCTL`            | `BPF_CGROUP_SYSCTL`                  | `cgroup/sysctl`                  |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_EXT`                      |                                        | `freplace+` [#fentry]_           |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_FLOW_DISSECTOR`           | `BPF_FLOW_DISSECTOR`                 | `flow_dissector`                 |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_KPROBE`                   |                                        | `kprobe+` [#kprobe]_             |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `kretprobe+` [#kprobe]_          |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `ksyscall+` [#ksyscall]_         |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        |  `kretsyscall+` [#ksyscall]_     |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `uprobe+` [#uprobe]_             |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `uprobe.s+` [#uprobe]_           | Yes       |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `uretprobe+` [#uprobe]_          |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `uretprobe.s+` [#uprobe]_        | Yes       |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `usdt+` [#usdt]_                 |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_TRACE_KPROBE_MULTI`             | `kprobe.multi+` [#kpmulti]_      |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `kretprobe.multi+` [#kpmulti]_    |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_LIRC_MODE2`               | `BPF_LIRC_MODE2`                     | `lirc_mode2`                     |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_LSM`                      | `BPF_LSM_CGROUP`                     | `lsm_cgroup+`                    |           |
+                                           +----------------------------------------+----------------------------------+-----------+
|                                           | `BPF_LSM_MAC`                        | `lsm+` [#lsm]_                   |           |
+                                           +                                        +----------------------------------+-----------+
|                                           |                                        | `lsm.s+` [#lsm]_                 | Yes       |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_LWT_IN`                   |                                        | `lwt_in`                         |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_LWT_OUT`                  |                                        | `lwt_out`                        |           |
+-------------------------------------------+----------------------------------------+----------------------------------+-----------+
| `BPF_PROG_TYPE_LWT_SEG6LOCAL`            |                                        | `
... [#tp] “跟踪点”（tracepoint）的附加格式为“tracepoint/<类别>/<名称>”
... [#iter] “迭代器”（iter）的附加格式为“iter[.s]/<结构体名称>”
