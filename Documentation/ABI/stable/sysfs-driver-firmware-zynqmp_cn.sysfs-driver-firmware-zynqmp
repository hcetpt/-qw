### 说明:

**路径:** `/sys/devices/platform/firmware\:zynqmp-firmware/ggs*`  
**日期:** 三月 2020  
**内核版本:** 5.6  
**联系人:** "Jolly Shah" <jollys@xilinx.com>  
**描述:**
    读取/写入 PMU 全局通用存储寄存器值，
    `GLOBAL_GEN_STORAGE{0:3}`
全局通用存储寄存器可用于系统在不同主控器之间传递信息。
该寄存器会在系统或上电复位时被重置。FSBL 和其他 Xilinx 软件产品使用了三个寄存器：`GLOBAL_GEN_STORAGE{4:6}`  
**用法:**

        # cat /sys/devices/platform/firmware\:zynqmp-firmware/ggs0
        # echo <value> > /sys/devices/platform/firmware\:zynqmp-firmware/ggs0

    **示例:**

        # cat /sys/devices/platform/firmware\:zynqmp-firmware/ggs0
        # echo 0x1234ABCD > /sys/devices/platform/firmware\:zynqmp-firmware/ggs0

**用户:** Xilinx

### 说明:

**路径:** `/sys/devices/platform/firmware\:zynqmp-firmware/pggs*`  
**日期:** 三月 2020  
**内核版本:** 5.6  
**联系人:** "Jolly Shah" <jollys@xilinx.com>  
**描述:**
    读取/写入 PMU 持久化全局通用存储寄存器值，
    `PERS_GLOB_GEN_STORAGE{0:3}`
持久化全局通用存储寄存器可用于系统在不同主控器之间传递信息。
此寄存器仅在上电复位时被重置，并且在系统复位期间保持其值不变。
FSBL 和其他 Xilinx 软件产品使用了四个寄存器：`PERS_GLOB_GEN_STORAGE{4:7}`
此寄存器仅通过 POR 重置进行重置。
**用法:**

        # cat /sys/devices/platform/firmware\:zynqmp-firmware/pggs0
        # echo <value> > /sys/devices/platform/firmware\:zynqmp-firmware/pggs0

    **示例:**

        # cat /sys/devices/platform/firmware\:zynqmp-firmware/pggs0
        # echo 0x1234ABCD > /sys/devices/platform/firmware\:zynqmp-firmware/pggs0

**用户:** Xilinx

### 说明:

**路径:** `/sys/devices/platform/firmware\:zynqmp-firmware/shutdown_scope`  
**日期:** 三月 2020  
**内核版本:** 5.6  
**联系人:** "Jolly Shah" <jollys@xilinx.com>  
**描述:**
    此 sysfs 接口允许设置下次关机请求的关机范围。当执行下一次关机时，特定平台部分的 PSCI-system_off 可以使用所选的关机范围。
以下是可以使用的关机范围（子类型）：

    子系统:
            仅 APU 及其所有未被其他处理单元使用的外设将被关闭。如果其他处理单元不使用 FPD 外设或 DRAM，则可能会导致 FPD 电源域被关闭。
### 关于 PS_only 的说明：
仅完全关闭 PS（包括 RPU、PMU 等），PL 域（FPGA）保持不变。

### 关于系统：
整个系统/设备被关闭。

#### 使用方法：

```
# 查看当前关闭范围
cat /sys/devices/platform/firmware\:zynqmp-firmware/shutdown_scope
# 设置关闭范围
echo <scope> > /sys/devices/platform/firmware\:zynqmp-firmware/shutdown_scope
```

#### 示例：

```
# 查看当前关闭范围
cat /sys/devices/platform/firmware\:zynqmp-firmware/shutdown_scope
# 设置关闭范围为子系统
echo "subsystem" > /sys/devices/platform/firmware\:zynqmp-firmware/shutdown_scope
```

### 用户：Xilinx

### 健康状态设置

#### 路径：
/sys/devices/platform/firmware\:zynqmp-firmware/health_status

#### 日期：
三月 2020

#### 内核版本：
5.6

#### 联系人：
"Jolly Shah" <jollys@xilinx.com>

#### 描述：
此 sysfs 接口允许设置健康状态。如果 PMUFW 编译时启用了 CHECK_HEALTHY_BOOT，它会在 FPD WDT 到期时检查健康位。如果健康位由运行在 Linux 中的用户应用程序设置，则 PMUFW 只会重启 APU；如果在 FPD WDT 到期时未设置健康位，则 PMUFW 将重启整个系统。

#### 使用方法：

- 设置健康位：
  ```
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/health_status
  ```

- 清除健康位：
  ```
  # echo 0 > /sys/devices/platform/firmware\:zynqmp-firmware/health_status
  ```

### 功能配置 ID

#### 路径：
/sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id

#### 日期：
二月 2022

#### 内核版本：
5.18

#### 联系人：
"Ronak Jain" <ronak.jain@xilinx.com>

#### 描述：
此 sysfs 接口允许用户在运行时配置功能。用户可以启用或禁用在固件中运行的功能，也可以在运行时配置这些功能的参数。支持的功能包括过热保护和外部看门狗。这里的外部看门狗与 /dev/watchdog 完全不同，因为它运行在固件上，用于监控固件而非 APU（Linux）的健康状况。此外，外部看门狗接口位于 ZynqMP SoC 外部。

支持的配置 ID 包括：
1. `PM_FEATURE_OVERTEMP_STATUS = 1`，用户可以启用或禁用过热保护功能。
2. `PM_FEATURE_OVERTEMP_VALUE = 2`，用户可以配置过热阈值（单位：摄氏度）。
3. `PM_FEATURE_EXTWDT_STATUS = 3`，用户可以启用或禁用外部看门狗功能。
4. `PM_FEATURE_EXTWDT_VALUE = 4`，用户可以配置外部看门狗功能。

#### 使用方法：

- 选择过热配置 ID 来启用/禁用功能：
  ```
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  ```

- 检查是否选择了过热配置 ID：
  ```
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  ```
  预期结果是 1

- 选择过热配置 ID 来配置过热阈值：
  ```
  # echo 2 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  ```

- 检查是否选择了过热配置 ID：
  ```
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  ```
  预期结果是 2
选择外部看门狗配置ID以启用或禁用功能
		# echo 3 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id

		检查是否已选择了外部看门狗配置ID
		# cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
		期望的结果是3
选择外部看门狗配置ID来配置时间间隔
		# echo 4 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id

		检查是否已选择了外部看门狗配置ID
		# cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
		期望的结果是4
用户：		Xilinx

何为：		/sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
日期：		2022年2月
内核版本：	5.18
联系人：	"Ronak Jain" <ronak.jain@xilinx.com>
描述：
		此sysfs接口允许在运行时配置功能
用户可以在固件中启用或禁用正在运行的功能
同时，用户还可以在运行时配置功能的参数
		支持的功能包括过温检测和外部看门狗。这里，外部看门狗与/dev/watchdog完全不同，因为外部看门狗运行在固件上，用于监控固件而非APU（Linux）的健康状况。此外，外部看门狗接口位于ZynqMP SoC之外。
默认情况下，固件中的功能处于禁用状态。用户
		可以通过查询相关功能的适当配置ID来启用这些功能
过温检测的默认限制是90摄氏度
外部看门狗的默认计时间隔为570毫秒
支持的配置ID用于功能配置如下，
		1. PM_FEATURE_OVERTEMP_STATUS = 1，用户可以启用或禁用过温检测功能
2. PM_FEATURE_OVERTEMP_VALUE = 2，用户可以配置过温检测的限制（单位：摄氏度）
### 翻译：

#### 定义：
3. `PM_FEATURE_EXTWDT_STATUS = 3`，用户可以启用或禁用外部看门狗功能。
4. `PM_FEATURE_EXTWDT_VALUE = 4`，用户可以配置外部看门狗功能。

#### 使用方法：

- **启用过温保护功能**
  ```shell
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查过温保护功能是否已启用**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `1`

- **禁用过温保护功能**
  ```shell
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 0 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查过温保护功能是否已禁用**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `0`

- **将过温限制设置为 50°C**
  ```shell
  # echo 2 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 50 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查过温限制是否已设置**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `50`

- **启用外部看门狗功能**
  ```shell
  # echo 3 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 1 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查外部看门狗功能是否已启用**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `1`

- **禁用外部看门狗功能**
  ```shell
  # echo 3 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 0 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查外部看门狗功能是否已禁用**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `0`

- **将外部看门狗计时器间隔设置为 500 毫秒**
  ```shell
  # echo 4 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_id
  # echo 500 > /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```

- **检查外部看门狗计时器间隔是否已设置**
  ```shell
  # cat /sys/devices/platform/firmware\:zynqmp-firmware/feature_config_value
  ```
  预期结果为 `500`

#### 用户：Xilinx
