SPDX 许可证标识符: GPL-2.0 或更高版本

==================
ACPI WMI 接口
==================

ACPI WMI 接口是微软对 ACPI 规范的一种专有扩展，旨在让硬件厂商能够将其 ACPI 固件内嵌入 WMI（Windows 管理规范）对象。典型的实现功能包括现代笔记本电脑上的热键事件和 PNP0C14 ACPI 设备的 BIOS 配置。

PNP0C14 ACPI 设备
-------------------

WMI 对象的发现通过定义具有 `PNP0C14` PNP ID 的 ACPI 设备来处理。这些设备将包含一组用于映射和执行 WMI 方法/查询的 ACPI 缓冲区和方法。如果存在多个这样的设备，则每个设备必须有一个唯一的 ACPI UID。

_WDG 缓冲区
-----------

`_WDG` 缓冲区用于发现 WMI 对象，并且需要是静态的。其内部结构由大小为 20 字节的数据块组成，包含以下数据：

======= =============== =====================================================
偏移量   大小（字节） 内容
======= =============== =====================================================
0x00     16            128 位 Variant 2 对象 GUID
0x10     2             2 个字符的方法 ID 或单字节的通知 ID
0x12     1             对象实例计数
0x13     1             对象标志
======= =============== =====================================================

WMI 对象标志控制方法或通知 ID 是否被使用：

- 0x1：数据块的使用是昂贵的，必须显式地启用/禁用
- 0x2：数据块包含 WMI 方法
- 0x4：数据块包含 ASCIZ 字符串
- 0x8：数据块描述一个 WMI 事件，应使用通知 ID 而不是方法 ID
每个WMI对象GUID可以在系统中出现多次。
方法/通知ID用于构建与WMI对象交互时使用的ACPI方法名称。

WQxx ACPI方法
--------------

如果数据块不包含WMI方法，则可以通过这个必需的ACPI方法检索其内容。ACPI方法名称的最后两个字符是待查询的数据块的方法ID。其单个参数是一个整数，描述了要查询的实例。如果数据块只包含一个实例，则可以省略此参数。

WSxx ACPI方法
--------------

类似于WQxx ACPI方法，不同之处在于它是可选的，并且接受一个额外的缓冲区作为第二个参数。实例参数也不能省略。

WMxx ACPI方法
--------------

用于执行与数据块关联的WMI方法。ACPI方法名称的最后两个字符是包含WMI方法的数据块的方法ID。其第一个参数是一个整数，描述了应执行方法的实例。第二个参数是一个整数，描述要执行的WMI方法ID，第三个参数是一个包含WMI方法参数的缓冲区。如果数据块被标记为包含ASCIZ字符串，则该缓冲区应包含ASCIZ字符串。ACPI方法将返回执行后的WMI方法的结果。

WExx ACPI方法
--------------

用于可选地启用或禁用WMI事件，ACPI方法的最后两个字符是以十六进制值表示的描述WMI事件的数据块的通知ID。其第一个参数是一个整数，如果要禁用WMI事件则值为0，其他值将启用WMI事件。

WCxx ACPI方法
--------------

类似于WExx ACPI方法，不同之处在于它控制的是数据收集而不是事件，因此ACPI方法名称的最后两个字符是待启用或禁用的数据块的方法ID。

_WED ACPI方法
--------------

用于检索额外的WMI事件数据，其单个参数是一个整数，表示事件的通知ID。每次接收到ACPI通知时都应评估此方法，因为某些ACPI实现使用队列来存储WMI事件数据项。在没有检索相关WMI事件数据的情况下接收几个WMI事件后，此队列将会溢出。
